<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kimball Dimensional Modeling ‚Äî Mastering the Architecture of Analytics</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23f0c55b'/%3E%3Cstop offset='100%25' stop-color='%23d4a032'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpolygon points='32,2 58,17 58,47 32,62 6,47 6,17' fill='%230a0e17' stroke='url(%23g)' stroke-width='3'/%3E%3Ctext x='32' y='42' text-anchor='middle' font-family='Georgia,serif' font-weight='700' font-size='30' fill='%23f0c55b'%3EK%3C/text%3E%3C/svg%3E">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800;900&family=Source+Sans+3:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-primary: #0a0e17;
  --bg-secondary: #111827;
  --bg-card: #1a2234;
  --bg-card-hover: #1e2a42;
  --bg-accent: #0f1a2e;
  --text-primary: #e8edf5;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;
  --accent-gold: #f0c55b;
  --accent-gold-dim: rgba(240, 197, 91, 0.15);
  --accent-blue: #3b82f6;
  --accent-blue-dim: rgba(59, 130, 246, 0.12);
  --accent-teal: #14b8a6;
  --accent-teal-dim: rgba(20, 184, 166, 0.12);
  --accent-purple: #a78bfa;
  --accent-purple-dim: rgba(167, 139, 250, 0.12);
  --accent-rose: #f43f5e;
  --accent-rose-dim: rgba(244, 63, 94, 0.12);
  --accent-orange: #f97316;
  --accent-orange-dim: rgba(249, 115, 22, 0.12);
  --accent-emerald: #10b981;
  --accent-emerald-dim: rgba(16, 185, 129, 0.12);
  --border-color: rgba(148, 163, 184, 0.1);
  --border-glow: rgba(240, 197, 91, 0.25);
  --shadow-soft: 0 4px 24px rgba(0, 0, 0, 0.3);
  --shadow-glow: 0 0 40px rgba(240, 197, 91, 0.08);
  --radius: 12px;
  --radius-lg: 20px;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; scroll-padding-top: 80px; }
body {
  font-family: 'Source Sans 3', sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.75;
  font-size: 17px;
  overflow-x: hidden;
}
body::before {
  content: '';
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 9999;
}
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: var(--bg-primary); }
::-webkit-scrollbar-thumb { background: var(--accent-gold); border-radius: 4px; }

/* ‚îÄ‚îÄ Nav ‚îÄ‚îÄ */
.top-nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
  background: rgba(10, 14, 23, 0.92); backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border-color);
  padding: 0 2rem; height: 70px;
  display: flex; align-items: center; justify-content: space-between;
}
.nav-brand {
  font-family: 'Playfair Display', serif;
  font-size: 1.3rem; font-weight: 700; color: var(--accent-gold);
  letter-spacing: 0.5px; white-space: nowrap;
}
/* ‚îÄ‚îÄ Desktop Dropdown Nav ‚îÄ‚îÄ */
.nav-links { display: flex; gap: 0.15rem; align-items: center; }
.nav-item {
  color: var(--text-secondary); font-size: 0.82rem; font-weight: 500;
  padding: 0.45rem 0.75rem; border-radius: 6px;
  transition: var(--transition); white-space: nowrap; cursor: pointer;
  user-select: none; position: relative;
}
.nav-item:hover, .nav-item.active {
  color: var(--accent-gold); background: var(--accent-gold-dim);
}
.nav-dropdown { position: relative; }
.nav-dropdown > .nav-item::after {
  content: ' ‚ñæ'; font-size: 0.65rem; opacity: 0.5;
}
.nav-dropdown-menu {
  position: absolute; top: calc(100% + 6px); left: 50%; transform: translateX(-50%);
  background: rgba(17, 24, 39, 0.97); backdrop-filter: blur(20px);
  border: 1px solid var(--border-color); border-radius: 10px;
  padding: 0.5rem; min-width: 180px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.4);
  opacity: 0; visibility: hidden;
  transition: opacity 0.2s, visibility 0.2s, transform 0.2s;
  transform: translateX(-50%) translateY(6px);
  z-index: 2000;
}
.nav-dropdown:hover > .nav-dropdown-menu,
.nav-dropdown.open > .nav-dropdown-menu {
  opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0);
}
.nav-dropdown-menu .nav-sub-item {
  display: block; width: 100%; text-align: left;
  color: var(--text-secondary); font-size: 0.82rem; font-weight: 500;
  padding: 0.5rem 0.85rem; border-radius: 6px;
  transition: var(--transition); cursor: pointer; user-select: none;
  white-space: nowrap;
}
.nav-dropdown-menu .nav-sub-item:hover,
.nav-dropdown-menu .nav-sub-item.active {
  color: var(--accent-gold); background: var(--accent-gold-dim);
}
.nav-dropdown-menu .dropdown-label {
  font-size: 0.65rem; font-weight: 700; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 1.5px;
  padding: 0.4rem 0.85rem 0.2rem; pointer-events: none;
}

/* ‚îÄ‚îÄ Hamburger Button ‚îÄ‚îÄ */
.hamburger {
  display: none; flex-direction: column; justify-content: center; gap: 5px;
  width: 36px; height: 36px; cursor: pointer;
  background: none; border: none; padding: 6px;
  border-radius: 6px; transition: var(--transition);
}
.hamburger:hover { background: var(--accent-gold-dim); }
.hamburger span {
  display: block; width: 100%; height: 2px; background: var(--text-secondary);
  border-radius: 2px; transition: all 0.3s;
}
.hamburger.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); background: var(--accent-gold); }
.hamburger.active span:nth-child(2) { opacity: 0; }
.hamburger.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); background: var(--accent-gold); }

/* ‚îÄ‚îÄ Mobile Slide-Out Menu ‚îÄ‚îÄ */
.mobile-menu {
  display: none; position: fixed; top: 70px; left: 0; right: 0; bottom: 0;
  background: rgba(10, 14, 23, 0.98); backdrop-filter: blur(20px);
  z-index: 1500; overflow-y: auto; padding: 1.5rem;
  transform: translateX(100%); transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}
.mobile-menu.open { transform: translateX(0); }
.mobile-menu-group { margin-bottom: 1.5rem; }
.mobile-menu-label {
  font-size: 0.7rem; font-weight: 700; color: var(--accent-gold);
  text-transform: uppercase; letter-spacing: 2px;
  padding: 0 0.5rem 0.5rem; border-bottom: 1px solid var(--border-color);
  margin-bottom: 0.4rem;
}
.mobile-menu-item {
  display: block; color: var(--text-secondary); font-size: 1rem; font-weight: 500;
  padding: 0.7rem 0.75rem; border-radius: 8px;
  transition: var(--transition); cursor: pointer; user-select: none;
}
.mobile-menu-item:hover, .mobile-menu-item.active {
  color: var(--accent-gold); background: var(--accent-gold-dim);
}

/* ‚îÄ‚îÄ Progress ‚îÄ‚îÄ */
.progress-container {
  position: fixed; top: 70px; left: 0; right: 0;
  height: 3px; background: rgba(255,255,255,0.05); z-index: 999;
}
.progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent-gold), var(--accent-orange)); transition: width 0.15s linear; }

/* ‚îÄ‚îÄ Hero ‚îÄ‚îÄ */
.hero {
  min-height: 100vh; display: flex; align-items: center; justify-content: center;
  text-align: center; padding: 6rem 2rem 4rem; position: relative; overflow: hidden;
}
.hero::before {
  content: ''; position: absolute; top: -30%; left: -20%; width: 140%; height: 160%;
  background: radial-gradient(ellipse at 30% 20%, rgba(240,197,91,0.06) 0%, transparent 50%),
              radial-gradient(ellipse at 70% 80%, rgba(59,130,246,0.04) 0%, transparent 50%),
              radial-gradient(ellipse at 50% 50%, rgba(167,139,250,0.03) 0%, transparent 60%);
  pointer-events: none;
}
.hero-content { position: relative; max-width: 900px; }
.hero-badge {
  display: inline-block; padding: 0.5rem 1.5rem;
  background: var(--accent-gold-dim); border: 1px solid rgba(240,197,91,0.2);
  border-radius: 50px; font-size: 0.85rem; font-weight: 600;
  color: var(--accent-gold); letter-spacing: 2px; text-transform: uppercase;
  margin-bottom: 2rem; animation: fadeSlideDown 0.8s ease-out;
}
.hero h1 {
  font-family: 'Playfair Display', serif;
  font-size: clamp(2.8rem, 6vw, 5rem); font-weight: 900;
  line-height: 1.1; margin-bottom: 1.5rem;
  animation: fadeSlideDown 0.8s ease-out 0.15s both;
}
.hero h1 .highlight {
  background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.hero .subtitle {
  font-size: 1.25rem; color: var(--text-secondary); max-width: 680px;
  margin: 0 auto 2.5rem; line-height: 1.8; animation: fadeSlideDown 0.8s ease-out 0.3s both;
}
.hero-meta {
  display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap;
  animation: fadeSlideDown 0.8s ease-out 0.45s both;
}
.hero-meta-item { display: flex; align-items: center; gap: 0.5rem; color: var(--text-muted); font-size: 0.9rem; }
.hero-meta-item .icon {
  width: 36px; height: 36px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center; font-size: 1rem;
}

/* ‚îÄ‚îÄ Section ‚îÄ‚îÄ */
.section { padding: 5rem 2rem; max-width: 1200px; margin: 0 auto; }
.section-header { text-align: center; margin-bottom: 4rem; }
.section-number {
  font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; font-weight: 600;
  color: var(--accent-gold); letter-spacing: 3px; text-transform: uppercase; margin-bottom: 0.75rem;
}
.section-title {
  font-family: 'Playfair Display', serif;
  font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; margin-bottom: 1rem; line-height: 1.2;
}
.section-subtitle { color: var(--text-secondary); font-size: 1.1rem; max-width: 700px; margin: 0 auto; }
.section-divider { width: 60px; height: 3px; background: linear-gradient(90deg, var(--accent-gold), var(--accent-orange)); border-radius: 3px; margin: 0 auto 2rem; }

/* ‚îÄ‚îÄ Card ‚îÄ‚îÄ */
.card {
  background: var(--bg-card); border: 1px solid var(--border-color);
  border-radius: var(--radius-lg); padding: 2rem;
  transition: var(--transition); position: relative; overflow: hidden;
}
.card:hover { border-color: var(--border-glow); box-shadow: var(--shadow-glow); transform: translateY(-2px); }
.card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; opacity: 0; transition: opacity 0.3s; }
.card:hover::before { opacity: 1; }
.card.gold::before { background: linear-gradient(90deg, var(--accent-gold), var(--accent-orange)); }
.card.blue::before { background: linear-gradient(90deg, var(--accent-blue), var(--accent-teal)); }
.card.purple::before { background: linear-gradient(90deg, var(--accent-purple), var(--accent-rose)); }
.card.teal::before { background: linear-gradient(90deg, var(--accent-teal), var(--accent-emerald)); }
.card.rose::before { background: linear-gradient(90deg, var(--accent-rose), var(--accent-orange)); }
.card.orange::before { background: linear-gradient(90deg, var(--accent-orange), var(--accent-gold)); }
.card-icon {
  width: 52px; height: 52px; border-radius: 14px;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.5rem; margin-bottom: 1.25rem;
}
.card h3 { font-family: 'Playfair Display', serif; font-size: 1.35rem; font-weight: 700; margin-bottom: 0.75rem; }
.card p, .card li { color: var(--text-secondary); font-size: 0.95rem; line-height: 1.75; }
.card-wide { padding: 2.5rem; }

/* ‚îÄ‚îÄ Grids ‚îÄ‚îÄ */
.grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); gap: 1.5rem; }
.grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
.grid-4 { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; }

/* ‚îÄ‚îÄ Analogy ‚îÄ‚îÄ */
.analogy-box {
  background: linear-gradient(135deg, rgba(240,197,91,0.08), rgba(249,115,22,0.05));
  border: 1px solid rgba(240,197,91,0.15); border-radius: var(--radius-lg);
  padding: 2rem; margin: 2rem 0; position: relative;
}
.analogy-box::before { content: 'üí°'; position: absolute; top: -14px; left: 24px; font-size: 1.5rem; background: var(--bg-primary); padding: 0 0.5rem; }
.analogy-box .analogy-title { font-family: 'Playfair Display', serif; font-size: 1.15rem; font-weight: 700; color: var(--accent-gold); margin-bottom: 0.75rem; }
.analogy-box p { color: var(--text-secondary); line-height: 1.8; }

/* ‚îÄ‚îÄ Code ‚îÄ‚îÄ */
.code-block {
  background: #0d1117; border: 1px solid rgba(148,163,184,0.1);
  border-radius: var(--radius); padding: 1.5rem; margin: 1.5rem 0;
  overflow-x: auto; position: relative;
}
.code-block .code-label {
  position: absolute; top: 0; right: 0;
  background: rgba(240,197,91,0.15); color: var(--accent-gold);
  font-family: 'JetBrains Mono', monospace; font-size: 0.7rem;
  font-weight: 600; padding: 0.3rem 0.8rem;
  border-radius: 0 11px 0 8px; letter-spacing: 1px; text-transform: uppercase;
}
.code-block pre {
  font-family: 'JetBrains Mono', monospace; font-size: 0.85rem;
  line-height: 1.7; color: #c9d1d9; white-space: pre; overflow-x: auto;
}
.code-block .kw { color: #ff7b72; }
.code-block .fn { color: #d2a8ff; }
.code-block .str { color: #a5d6ff; }
.code-block .cm { color: #8b949e; }
.code-block .type { color: #79c0ff; }
.code-block .num { color: #f0c55b; }

/* ‚îÄ‚îÄ Diagram ‚îÄ‚îÄ */
.diagram-container {
  background: var(--bg-card); border: 1px solid var(--border-color);
  border-radius: var(--radius-lg); padding: 2.5rem; margin: 2rem 0;
  text-align: center; overflow-x: auto;
}
.diagram-title { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 700; margin-bottom: 1.5rem; color: var(--accent-gold); }

/* ‚îÄ‚îÄ Table ‚îÄ‚îÄ */
.styled-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.9rem; }
.styled-table thead th {
  background: rgba(240,197,91,0.1); color: var(--accent-gold);
  font-weight: 600; text-align: left; padding: 0.8rem 1rem;
  border-bottom: 2px solid rgba(240,197,91,0.2);
  font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;
  letter-spacing: 0.5px; text-transform: uppercase;
}
.styled-table tbody td { padding: 0.7rem 1rem; border-bottom: 1px solid var(--border-color); color: var(--text-secondary); }
.styled-table tbody tr:hover { background: rgba(255,255,255,0.02); }

/* ‚îÄ‚îÄ Level Badges ‚îÄ‚îÄ */
.level-badge {
  display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.35rem 1rem;
  border-radius: 50px; font-size: 0.8rem; font-weight: 600; letter-spacing: 0.5px; margin-bottom: 1rem;
}
.level-simple { background: var(--accent-emerald-dim); color: var(--accent-emerald); border: 1px solid rgba(16,185,129,0.2); }
.level-medium { background: var(--accent-blue-dim); color: var(--accent-blue); border: 1px solid rgba(59,130,246,0.2); }
.level-advanced { background: var(--accent-purple-dim); color: var(--accent-purple); border: 1px solid rgba(167,139,250,0.2); }
.level-complex { background: var(--accent-rose-dim); color: var(--accent-rose); border: 1px solid rgba(244,63,94,0.2); }
.level-real { background: var(--accent-gold-dim); color: var(--accent-gold); border: 1px solid rgba(240,197,91,0.2); }

/* ‚îÄ‚îÄ Steps ‚îÄ‚îÄ */
.process-steps { display: flex; flex-direction: column; gap: 1rem; margin: 2rem 0; }
.process-step {
  display: flex; align-items: flex-start; gap: 1.25rem; padding: 1.5rem;
  background: var(--bg-card); border: 1px solid var(--border-color);
  border-radius: var(--radius); transition: var(--transition);
}
.process-step:hover { border-color: var(--border-glow); transform: translateX(4px); }
.step-num {
  width: 42px; height: 42px; min-width: 42px; border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-family: 'JetBrains Mono', monospace; font-weight: 700; font-size: 1rem;
  background: var(--accent-gold-dim); color: var(--accent-gold);
  border: 1px solid rgba(240,197,91,0.2);
}
.step-content h4 { font-family: 'Playfair Display', serif; font-size: 1.1rem; margin-bottom: 0.4rem; }
.step-content p { color: var(--text-secondary); font-size: 0.92rem; }

/* ‚îÄ‚îÄ Callout ‚îÄ‚îÄ */
.callout {
  border-radius: var(--radius); padding: 1.5rem 1.5rem 1.5rem 3.5rem;
  margin: 1.5rem 0; position: relative; border-left: 3px solid;
}
.callout::before { position: absolute; left: 1rem; top: 1.4rem; font-size: 1.2rem; }
.callout-warning { background: var(--accent-orange-dim); border-color: var(--accent-orange); }
.callout-warning::before { content: '‚ö†Ô∏è'; }
.callout-tip { background: var(--accent-teal-dim); border-color: var(--accent-teal); }
.callout-tip::before { content: '‚úÖ'; }
.callout-info { background: var(--accent-blue-dim); border-color: var(--accent-blue); }
.callout-info::before { content: '‚ÑπÔ∏è'; }
.callout-key { background: var(--accent-gold-dim); border-color: var(--accent-gold); }
.callout-key::before { content: 'üîë'; }
.callout h4 { font-weight: 700; margin-bottom: 0.3rem; }
.callout p { color: var(--text-secondary); font-size: 0.92rem; }

/* ‚îÄ‚îÄ Misc ‚îÄ‚îÄ */
ul.clean-list { list-style: none; padding: 0; }
ul.clean-list li { padding: 0.4rem 0 0.4rem 1.5rem; position: relative; color: var(--text-secondary); }
ul.clean-list li::before { content: '‚Üí'; position: absolute; left: 0; color: var(--accent-gold); font-weight: 600; }
.tag-row { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.75rem 0; }
.tag { display: inline-block; padding: 0.2rem 0.7rem; border-radius: 50px; font-size: 0.75rem; font-weight: 600; border: 1px solid; }
.tag-gold { background: var(--accent-gold-dim); color: var(--accent-gold); border-color: rgba(240,197,91,0.2); }
.tag-blue { background: var(--accent-blue-dim); color: var(--accent-blue); border-color: rgba(59,130,246,0.2); }
.tag-teal { background: var(--accent-teal-dim); color: var(--accent-teal); border-color: rgba(20,184,166,0.2); }
.tag-purple { background: var(--accent-purple-dim); color: var(--accent-purple); border-color: rgba(167,139,250,0.2); }
.tag-rose { background: var(--accent-rose-dim); color: var(--accent-rose); border-color: rgba(244,63,94,0.2); }
.flow-row { display: flex; align-items: center; justify-content: center; gap: 0.5rem; flex-wrap: wrap; margin: 1.5rem 0; }
.flow-box { padding: 0.6rem 1.2rem; border-radius: 8px; font-size: 0.85rem; font-weight: 600; border: 1px solid; }
.flow-arrow { color: var(--accent-gold); font-size: 1.2rem; }
.comparison-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin: 2rem 0; }
.complexity-line { display: flex; align-items: center; justify-content: space-between; margin: 2rem 0; position: relative; padding: 0 1rem; }
.complexity-line::before { content: ''; position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, var(--accent-emerald), var(--accent-blue), var(--accent-purple), var(--accent-rose), var(--accent-gold)); transform: translateY(-50%); z-index: 0; }
.complexity-node { position: relative; z-index: 1; text-align: center; }
.complexity-circle { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; margin: 0 auto 0.4rem; }
.complexity-label { font-size: 0.72rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

/* ‚îÄ‚îÄ Q&A ‚îÄ‚îÄ */
.qa-item { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: var(--radius); margin-bottom: 1rem; overflow: hidden; transition: var(--transition); }
.qa-question { padding: 1.25rem 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: space-between; gap: 1rem; font-weight: 600; font-size: 1rem; transition: var(--transition); }
.qa-question:hover { background: rgba(255,255,255,0.02); }
.qa-question .q-icon { width: 28px; height: 28px; min-width: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center; background: var(--accent-gold-dim); color: var(--accent-gold); font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; font-weight: 700; }
.qa-toggle { transition: transform 0.3s; color: var(--text-muted); }
.qa-item.open .qa-toggle { transform: rotate(180deg); }
.qa-answer { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
.qa-item.open .qa-answer { max-height: 1200px; }
.qa-answer-inner { padding: 0 1.5rem 1.5rem; color: var(--text-secondary); line-height: 1.8; border-top: 1px solid var(--border-color); padding-top: 1.25rem; }

/* ‚îÄ‚îÄ Exercise Box ‚îÄ‚îÄ */
.exercise-box {
  background: linear-gradient(135deg, rgba(59,130,246,0.08), rgba(20,184,166,0.05));
  border: 1px solid rgba(59,130,246,0.2); border-radius: var(--radius-lg);
  padding: 2rem; margin: 1.5rem 0; position: relative;
}
.exercise-box::before { content: 'üèãÔ∏è'; position: absolute; top: -14px; left: 24px; font-size: 1.5rem; background: var(--bg-primary); padding: 0 0.5rem; }
.exercise-box .exercise-title { font-family: 'Playfair Display', serif; font-size: 1.1rem; font-weight: 700; color: var(--accent-blue); margin-bottom: 0.5rem; }
.exercise-box .exercise-difficulty { font-size: 0.8rem; font-weight: 600; margin-bottom: 0.75rem; }
.exercise-box p, .exercise-box li { color: var(--text-secondary); line-height: 1.8; }

/* ‚îÄ‚îÄ Cheat Sheet Table ‚îÄ‚îÄ */
.cheat-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
.cheat-table td, .cheat-table th { padding: 0.6rem 0.8rem; border: 1px solid var(--border-color); }
.cheat-table th { background: var(--accent-gold-dim); color: var(--accent-gold); font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; text-align: left; }
.cheat-table td { color: var(--text-secondary); }
.cheat-table td:first-child { color: var(--text-primary); font-weight: 600; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; }

/* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
.footer { padding: 4rem 2rem 2rem; border-top: 1px solid var(--border-color); text-align: center; }
.footer-links { display: flex; gap: 1.5rem; justify-content: center; margin-bottom: 1.5rem; flex-wrap: wrap; }
.footer-links a { color: var(--text-secondary); text-decoration: none; font-size: 0.9rem; padding: 0.4rem 1rem; border-radius: 6px; border: 1px solid var(--border-color); transition: var(--transition); }
.footer-links a:hover { color: var(--accent-gold); border-color: rgba(240,197,91,0.3); background: var(--accent-gold-dim); }
.footer-credit { color: var(--text-muted); font-size: 0.85rem; margin-top: 1rem; }

/* ‚îÄ‚îÄ Toc sidebar ‚îÄ‚îÄ */
.toc-sidebar { position: fixed; right: 1.5rem; top: 50%; transform: translateY(-50%); z-index: 100; display: flex; flex-direction: column; gap: 6px; }
.toc-dot { width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.15); transition: var(--transition); cursor: pointer; }
.toc-dot:hover, .toc-dot.active { background: var(--accent-gold); border-color: var(--accent-gold); box-shadow: 0 0 10px rgba(240,197,91,0.3); transform: scale(1.3); }

/* ‚îÄ‚îÄ Animations ‚îÄ‚îÄ */
@keyframes fadeSlideDown { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
@media (max-width: 1100px) {
  .nav-links { display: none; }
  .hamburger { display: flex; }
  .mobile-menu { display: block; }
}
@media (max-width: 768px) {
  .top-nav { padding: 0 1rem; }
  .section { padding: 3rem 1rem; }
  .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
  .comparison-grid { grid-template-columns: 1fr; }
  .hero { padding: 5rem 1.5rem 3rem; }
}
@media (min-width: 1101px) {
  .hamburger { display: none; }
  .mobile-menu { display: none !important; }
}
@media (max-width: 1024px) { .toc-sidebar { display: none; } }
@media (min-width: 1025px) { .main-content { padding-right: 3rem; } }
</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê NAV ‚Äî Grouped dropdowns on desktop, hamburger slide-out on mobile ‚ïê‚ïê‚ïê -->
<nav class="top-nav">
  <div class="nav-brand">‚¨° Kimball Architecture</div>

  <!-- Desktop nav with dropdowns -->
  <div class="nav-links" id="mainNav">
    <span class="nav-item" data-target="hero">Home</span>

    <div class="nav-dropdown">
      <span class="nav-item">Foundations</span>
      <div class="nav-dropdown-menu">
        <div class="dropdown-label">Learn the Basics</div>
        <span class="nav-sub-item" data-target="what-is-kimball">What Is Kimball</span>
        <span class="nav-sub-item" data-target="core-concepts">Core Concepts</span>
        <span class="nav-sub-item" data-target="kimball-lifecycle">Kimball Lifecycle</span>
        <span class="nav-sub-item" data-target="four-step">4-Step Design Process</span>
        <span class="nav-sub-item" data-target="bus-matrix">Bus Matrix</span>
      </div>
    </div>

    <div class="nav-dropdown">
      <span class="nav-item">Comparisons</span>
      <div class="nav-dropdown-menu">
        <div class="dropdown-label">Architecture Face-Offs</div>
        <span class="nav-sub-item" data-target="kimball-vs-inmon">Kimball vs. Inmon</span>
        <span class="nav-sub-item" data-target="kimball-vs-medallion">Kimball vs. Medallion</span>
        <span class="nav-sub-item" data-target="data-vault">Kimball vs. Data Vault</span>
        <span class="nav-sub-item" data-target="pros-cons">Pros &amp; Cons</span>
      </div>
    </div>

    <div class="nav-dropdown">
      <span class="nav-item">Schemas</span>
      <div class="nav-dropdown-menu">
        <div class="dropdown-label">Modeling Patterns</div>
        <span class="nav-sub-item" data-target="star-schema">Star Schema</span>
        <span class="nav-sub-item" data-target="snowflake-schema">Snowflake Schema</span>
        <span class="nav-sub-item" data-target="scd">Slowly Changing Dims</span>
        <span class="nav-sub-item" data-target="conformed-dims">Conformed Dimensions</span>
        <span class="nav-sub-item" data-target="role-playing-dims">Role-Playing Dimensions</span>
      </div>
    </div>

    <div class="nav-dropdown">
      <span class="nav-item">Examples</span>
      <div class="nav-dropdown-menu">
        <div class="dropdown-label">Simple ‚Üí Complex</div>
        <span class="nav-sub-item" data-target="simple">‚òï Coffee Shop</span>
        <span class="nav-sub-item" data-target="medium">üíª SaaS Platform</span>
        <span class="nav-sub-item" data-target="advanced">üè¨ Multi-Channel Retail</span>
        <span class="nav-sub-item" data-target="complex">üè• Healthcare Claims</span>
        <span class="nav-sub-item" data-target="ecommerce">üõí E-Commerce Case Study</span>
      </div>
    </div>

    <div class="nav-dropdown">
      <span class="nav-item">Practical</span>
      <div class="nav-dropdown-menu">
        <div class="dropdown-label">Apply It</div>
        <span class="nav-sub-item" data-target="dbt-impl">dbt Implementation</span>
        <span class="nav-sub-item" data-target="etl-patterns">ETL/ELT Patterns</span>
        <span class="nav-sub-item" data-target="naming">Naming Conventions</span>
        <span class="nav-sub-item" data-target="testing">Testing &amp; Quality</span>
        <span class="nav-sub-item" data-target="exercises">Hands-On Exercises</span>
      </div>
    </div>

    <div class="nav-dropdown">
      <span class="nav-item">Reference</span>
      <div class="nav-dropdown-menu">
        <div class="dropdown-label">Quick Access</div>
        <span class="nav-sub-item" data-target="semantic-layer">Semantic &amp; Metrics Layer</span>
        <span class="nav-sub-item" data-target="performance-tuning">Performance Tuning</span>
        <span class="nav-sub-item" data-target="best-practices">Best Practices</span>
        <span class="nav-sub-item" data-target="cheatsheet">Cheat Sheet</span>
        <span class="nav-sub-item" data-target="qa">Q&amp;A (25 Questions)</span>
      </div>
    </div>
  </div>

  <!-- Hamburger button (visible ‚â§1100px) -->
  <button class="hamburger" id="hamburgerBtn" aria-label="Toggle menu">
    <span></span><span></span><span></span>
  </button>
</nav>

<!-- Mobile slide-out menu -->
<div class="mobile-menu" id="mobileMenu">
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Home</div>
    <span class="mobile-menu-item" data-target="hero">üè† Home</span>
  </div>
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Foundations</div>
    <span class="mobile-menu-item" data-target="what-is-kimball">What Is Kimball</span>
    <span class="mobile-menu-item" data-target="core-concepts">Core Concepts</span>
    <span class="mobile-menu-item" data-target="kimball-lifecycle">Kimball Lifecycle</span>
    <span class="mobile-menu-item" data-target="four-step">4-Step Design Process</span>
    <span class="mobile-menu-item" data-target="bus-matrix">Bus Matrix</span>
  </div>
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Comparisons</div>
    <span class="mobile-menu-item" data-target="kimball-vs-inmon">Kimball vs. Inmon</span>
    <span class="mobile-menu-item" data-target="kimball-vs-medallion">Kimball vs. Medallion</span>
    <span class="mobile-menu-item" data-target="data-vault">Kimball vs. Data Vault</span>
    <span class="mobile-menu-item" data-target="pros-cons">Pros &amp; Cons</span>
  </div>
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Schemas &amp; Patterns</div>
    <span class="mobile-menu-item" data-target="star-schema">Star Schema</span>
    <span class="mobile-menu-item" data-target="snowflake-schema">Snowflake Schema</span>
    <span class="mobile-menu-item" data-target="scd">Slowly Changing Dimensions</span>
    <span class="mobile-menu-item" data-target="conformed-dims">Conformed Dimensions</span>
    <span class="mobile-menu-item" data-target="role-playing-dims">Role-Playing Dimensions</span>
  </div>
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Examples (Simple ‚Üí Complex)</div>
    <span class="mobile-menu-item" data-target="simple">‚òï Coffee Shop</span>
    <span class="mobile-menu-item" data-target="medium">üíª SaaS Platform</span>
    <span class="mobile-menu-item" data-target="advanced">üè¨ Multi-Channel Retail</span>
    <span class="mobile-menu-item" data-target="complex">üè• Healthcare Claims</span>
    <span class="mobile-menu-item" data-target="ecommerce">üõí E-Commerce Case Study</span>
  </div>
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Practical</div>
    <span class="mobile-menu-item" data-target="dbt-impl">dbt Implementation</span>
    <span class="mobile-menu-item" data-target="etl-patterns">ETL/ELT Patterns</span>
    <span class="mobile-menu-item" data-target="naming">Naming Conventions</span>
    <span class="mobile-menu-item" data-target="testing">Testing &amp; Quality</span>
    <span class="mobile-menu-item" data-target="exercises">Hands-On Exercises</span>
  </div>
  <div class="mobile-menu-group">
    <div class="mobile-menu-label">Reference</div>
    <span class="mobile-menu-item" data-target="semantic-layer">Semantic &amp; Metrics Layer</span>
    <span class="mobile-menu-item" data-target="performance-tuning">Performance Tuning</span>
    <span class="mobile-menu-item" data-target="best-practices">Best Practices</span>
    <span class="mobile-menu-item" data-target="cheatsheet">Cheat Sheet</span>
    <span class="mobile-menu-item" data-target="qa">Q&amp;A (25 Questions)</span>
  </div>
</div>

<div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
<div class="toc-sidebar" id="tocSidebar"></div>

<div class="main-content">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="hero" id="hero">
  <div class="hero-content">
    <div class="hero-badge">AI Catalyst Cohort ‚Äî Data Architecture Deep Dive</div>
    <h1>Mastering <span class="highlight">Kimball's</span> Dimensional Modeling</h1>
    <p class="subtitle">
      The definitive guide to building analytics-ready data warehouses. From foundational concepts and relatable analogies to real-world e-commerce implementations and hands-on exercises ‚Äî everything you need to think dimensionally and <strong>apply it on Day 1</strong>.
    </p>
    <div class="hero-meta">
      <div class="hero-meta-item"><div class="icon" style="background:var(--accent-gold-dim);color:var(--accent-gold);">üìñ</div><span>29 Sections</span></div>
      <div class="hero-meta-item"><div class="icon" style="background:var(--accent-blue-dim);color:var(--accent-blue);">üéØ</div><span>5 Complexity Levels</span></div>
      <div class="hero-meta-item"><div class="icon" style="background:var(--accent-teal-dim);color:var(--accent-teal);">üèóÔ∏è</div><span>Real Case Study</span></div>
      <div class="hero-meta-item"><div class="icon" style="background:var(--accent-purple-dim);color:var(--accent-purple);">üõ†Ô∏è</div><span>dbt + Exercises</span></div>
      <div class="hero-meta-item"><div class="icon" style="background:var(--accent-rose-dim);color:var(--accent-rose);">‚ùì</div><span>25+ Q&A</span></div>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 01 ‚Äî WHAT IS KIMBALL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="what-is-kimball">
  <div class="section-header">
    <div class="section-number">Section 01</div>
    <h2 class="section-title">What Is Kimball Architecture?</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Ralph Kimball's bottom-up approach to data warehousing ‚Äî one business process at a time.</p>
  </div>
  <div class="grid-2">
    <div class="card gold">
      <div class="card-icon" style="background:var(--accent-gold-dim);color:var(--accent-gold);">üèõÔ∏è</div>
      <h3>The Origin Story</h3>
      <p>Ralph Kimball published <strong>"The Data Warehouse Toolkit"</strong> in 1996 and changed how organizations model analytical data. Rather than forcing users to navigate complex normalized structures, Kimball proposed organizing data around <em>business processes</em> using intuitive dimensional models.</p>
      <p style="margin-top:0.75rem;">His philosophy: <strong>"The data warehouse is only as good as the queries it enables."</strong></p>
    </div>
    <div class="card blue">
      <div class="card-icon" style="background:var(--accent-blue-dim);color:var(--accent-blue);">üß†</div>
      <h3>The Core Philosophy</h3>
      <ul class="clean-list">
        <li><strong>Bottom-up approach:</strong> Build one data mart at a time, each focused on a single business process</li>
        <li><strong>Business process-centric:</strong> Model around what the business <em>does</em>, not how IT stores data</li>
        <li><strong>Conformed dimensions:</strong> Share common vocabularies across marts for consistency</li>
        <li><strong>User accessibility:</strong> Star schemas are intuitive ‚Äî users can query them directly</li>
        <li><strong>Query performance:</strong> Denormalized structures minimize joins and maximize speed</li>
      </ul>
    </div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî The IKEA Showroom</div>
    <p>You don't walk into a giant warehouse of raw lumber and screws (that's normalized/Inmon-style). Instead, IKEA gives you <strong>fully assembled showrooms</strong> ‚Äî a living room, a kitchen, a bedroom ‚Äî each a self-contained, easy-to-browse display. That's Kimball: each showroom is a <strong>data mart</strong> (star schema), focused on a single area, designed so anyone can walk in and immediately understand what's there. The "conformed dimensions" are the standard product catalog and price tags that work identically across every showroom.</p>
  </div>
  <div class="callout callout-key">
    <h4>Key Takeaway</h4>
    <p>Kimball doesn't boil the ocean. Start with the highest-priority business process, model it as a star schema, deliver value fast, then expand by adding more stars ‚Äî all connected via shared (conformed) dimensions.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 02 ‚Äî CORE CONCEPTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="core-concepts">
  <div class="section-header">
    <div class="section-number">Section 02</div>
    <h2 class="section-title">Core Concepts &amp; Building Blocks</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">The essential vocabulary ‚Äî facts, dimensions, grains, and keys.</p>
  </div>
  <div class="grid-3">
    <div class="card gold">
      <div class="card-icon" style="background:var(--accent-gold-dim);color:var(--accent-gold);">üìä</div>
      <h3>Fact Tables</h3>
      <p>The <strong>center of the star</strong>. Store the quantitative, measurable events of a business process.</p>
      <ul class="clean-list" style="margin-top:0.75rem;">
        <li><strong>Grain:</strong> One row per event (e.g., one line item per order)</li>
        <li><strong>Measures:</strong> Numeric values you aggregate ‚Äî revenue, quantity, discount</li>
        <li><strong>Foreign keys:</strong> Pointers to every dimension table</li>
        <li>Typically the <strong>largest table</strong> ‚Äî millions to billions of rows</li>
        <li>Usually append-only; historical records rarely change</li>
      </ul>
      <div class="tag-row">
        <span class="tag tag-gold">Additive</span>
        <span class="tag tag-gold">Semi-Additive</span>
        <span class="tag tag-gold">Non-Additive</span>
      </div>
    </div>
    <div class="card blue">
      <div class="card-icon" style="background:var(--accent-blue-dim);color:var(--accent-blue);">üì¶</div>
      <h3>Dimension Tables</h3>
      <p>The <strong>points of the star</strong>. Provide the descriptive context ‚Äî who, what, where, when, why, how.</p>
      <ul class="clean-list" style="margin-top:0.75rem;">
        <li><strong>Attributes:</strong> Textual descriptions for filtering, grouping, labeling</li>
        <li><strong>Surrogate keys:</strong> System-generated integer PKs (not business keys)</li>
        <li><strong>Wide and flat:</strong> Dozens of columns, denormalized for ease</li>
        <li><strong>Few rows:</strong> Typically thousands to low millions</li>
        <li>Change slowly over time (handled by SCDs)</li>
      </ul>
      <div class="tag-row">
        <span class="tag tag-blue">Customer</span>
        <span class="tag tag-blue">Product</span>
        <span class="tag tag-blue">Date</span>
        <span class="tag tag-blue">Geography</span>
      </div>
    </div>
    <div class="card teal">
      <div class="card-icon" style="background:var(--accent-teal-dim);color:var(--accent-teal);">üîë</div>
      <h3>Grain, Keys &amp; Relationships</h3>
      <p>The <strong>structural glue</strong>. Getting the grain right is the single most important design decision.</p>
      <ul class="clean-list" style="margin-top:0.75rem;">
        <li><strong>Grain:</strong> The most atomic level of detail in the fact table</li>
        <li><strong>Surrogate key (SK):</strong> Warehouse-assigned integer PK for dimensions</li>
        <li><strong>Natural/business key (NK):</strong> The source-system identifier</li>
        <li><strong>Degenerate dimension:</strong> A dim with no table ‚Äî just a FK in the fact (e.g., order_number)</li>
        <li><strong>Conformed dimension:</strong> Shared across multiple fact tables</li>
      </ul>
    </div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî The Restaurant Receipt</div>
    <p>Your dinner receipt: the <strong>fact table</strong> is each line item ‚Äî "1√ó Margherita Pizza ‚Äî ‚Ç¨12.00". The <strong>measures</strong> are quantity (1) and price (‚Ç¨12.00). The <strong>dimensions</strong> are: <em>which restaurant</em>, <em>which waiter</em>, <em>what date & time</em>, <em>what dish</em>, <em>who paid</em>. The <strong>grain</strong> is "one line item on one receipt at one restaurant". The receipt number itself is a <strong>degenerate dimension</strong> ‚Äî it lives directly in the fact row.</p>
  </div>
  <h3 style="font-family:'Playfair Display',serif;font-size:1.5rem;margin:3rem 0 1.5rem;">Three Types of Fact Tables</h3>
  <div class="grid-3">
    <div class="card orange">
      <h3>Transaction Facts</h3>
      <p>One row per <strong>event</strong> at a point in time. Most common and most granular.</p>
      <p style="margin-top:0.5rem;"><strong>Example:</strong> Each retail sale, each click, each call.</p>
      <p style="margin-top:0.5rem;color:var(--accent-orange);font-weight:600;">Measures: fully additive (revenue, quantity, cost)</p>
    </div>
    <div class="card purple">
      <h3>Periodic Snapshot Facts</h3>
      <p>One row per <strong>time period</strong>, summarizing cumulative state at regular intervals.</p>
      <p style="margin-top:0.5rem;"><strong>Example:</strong> Monthly account balance, weekly inventory levels.</p>
      <p style="margin-top:0.5rem;color:var(--accent-purple);font-weight:600;">Measures: often semi-additive (can't sum across time)</p>
    </div>
    <div class="card rose">
      <h3>Accumulating Snapshot Facts</h3>
      <p>One row per <strong>lifecycle instance</strong>, updated as milestones are reached.</p>
      <p style="margin-top:0.5rem;"><strong>Example:</strong> Order lifecycle (ordered ‚Üí shipped ‚Üí delivered ‚Üí returned).</p>
      <p style="margin-top:0.5rem;color:var(--accent-rose);font-weight:600;">Measures: mix of additive + date stamps per milestone</p>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 03 ‚Äî KIMBALL vs INMON ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="kimball-vs-inmon">
  <div class="section-header">
    <div class="section-number">Section 03</div>
    <h2 class="section-title">Kimball vs. Inmon ‚Äî The Great Debate</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Same goal, radically different philosophies.</p>
  </div>
  <div class="comparison-grid">
    <div class="card gold card-wide">
      <h3>‚≠ê Kimball (Bottom-Up)</h3>
      <ul class="clean-list">
        <li><strong>Approach:</strong> Build individual data marts first; warehouse emerges from connected marts</li>
        <li><strong>Schema:</strong> Star/snowflake schemas</li>
        <li><strong>Speed to value:</strong> Fast ‚Äî usable mart in weeks</li>
        <li><strong>Normalization:</strong> Denormalized dimensions for query speed</li>
        <li><strong>Audience:</strong> Business users can self-serve</li>
        <li><strong>Best for:</strong> Fast ROI, agile teams, BI-heavy workloads</li>
      </ul>
    </div>
    <div class="card purple card-wide">
      <h3>üèóÔ∏è Inmon (Top-Down)</h3>
      <ul class="clean-list">
        <li><strong>Approach:</strong> Build centralized normalized EDW first; marts are derived</li>
        <li><strong>Schema:</strong> 3NF (Third Normal Form)</li>
        <li><strong>Speed to value:</strong> Slow ‚Äî full enterprise model first</li>
        <li><strong>Normalization:</strong> Highly normalized to eliminate redundancy</li>
        <li><strong>Audience:</strong> IT/data engineers; business needs derived layers</li>
        <li><strong>Best for:</strong> Strict governance, regulated industries</li>
      </ul>
    </div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Building a City</div>
    <p><strong>Inmon</strong> = A central city planner who drafts the entire blueprint ‚Äî roads, sewage, zoning ‚Äî before laying a single brick. Nothing opens until the master plan is done. <strong>Kimball</strong> = Building individual neighborhoods people can move into immediately, each with shops and parks, but all sharing the same road naming system and postal code format.</p>
  </div>
  <div class="callout callout-info">
    <h4>Modern Reality</h4>
    <p>Most modern data stacks (dbt, Snowflake, BigQuery) use a <strong>hybrid approach</strong>: raw data lands in staging (ELT), gets cleaned into a normalized-ish intermediate layer, and is then modeled into Kimball-style star schemas for the analytics/BI layer. The best of both worlds.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî KIMBALL vs MEDALLION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="kimball-vs-medallion">
  <div class="section-header">
    <div class="section-number">Section 04</div>
    <h2 class="section-title">Kimball vs. Medallion Architecture</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Two dominant paradigms in modern data ‚Äî competitors or complements?</p>
  </div>

  <div class="grid-2">
    <div class="card gold card-wide">
      <div class="card-icon" style="background:var(--accent-gold-dim);color:var(--accent-gold);">‚≠ê</div>
      <h3>Kimball Dimensional Modeling</h3>
      <ul class="clean-list">
        <li><strong>Focus:</strong> How data is <em>modeled</em> for analytics (star schemas, conformed dims)</li>
        <li><strong>Origin:</strong> Ralph Kimball, 1996 ‚Äî "The Data Warehouse Toolkit"</li>
        <li><strong>Core unit:</strong> Star schema (fact + dimension tables)</li>
        <li><strong>Methodology:</strong> 4-step process (process ‚Üí grain ‚Üí dims ‚Üí facts)</li>
        <li><strong>Audience:</strong> Business analysts, BI dashboards</li>
        <li><strong>Key question it answers:</strong> "How should we <em>structure</em> the final analytical tables?"</li>
      </ul>
    </div>
    <div class="card purple card-wide">
      <div class="card-icon" style="background:var(--accent-purple-dim);color:var(--accent-purple);">ü•á</div>
      <h3>Medallion Architecture (Bronze / Silver / Gold)</h3>
      <ul class="clean-list">
        <li><strong>Focus:</strong> How data <em>flows and matures</em> through processing stages</li>
        <li><strong>Origin:</strong> Databricks, ~2020 ‚Äî Popularized with Delta Lake / Lakehouse</li>
        <li><strong>Core unit:</strong> Three layers (Bronze ‚Üí Silver ‚Üí Gold)</li>
        <li><strong>Methodology:</strong> Progressive refinement of data quality</li>
        <li><strong>Audience:</strong> Data engineers, ML engineers, and analysts</li>
        <li><strong>Key question it answers:</strong> "How should we <em>organize the flow</em> from raw to refined?"</li>
      </ul>
    </div>
  </div>

  <div class="diagram-container" style="margin-top:2rem;">
    <div class="diagram-title">Medallion Layers Explained</div>
    <div class="flow-row" style="margin:2rem 0;">
      <div class="flow-box" style="background:var(--accent-orange-dim);color:var(--accent-orange);border-color:rgba(249,115,22,0.3);">
        <strong>ü•â Bronze</strong><br><span style="font-size:0.78rem;">Raw ingestion. Exact copy of source data. No transforms. Append-only. Full audit trail.</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-blue-dim);color:var(--accent-blue);border-color:rgba(59,130,246,0.3);">
        <strong>ü•à Silver</strong><br><span style="font-size:0.78rem;">Cleaned, deduplicated, standardized. Normalized or lightly modeled. Business rules applied.</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-gold-dim);color:var(--accent-gold);border-color:rgba(240,197,91,0.3);">
        <strong>ü•á Gold</strong><br><span style="font-size:0.78rem;">Business-ready. Aggregated, modeled for consumption. BI dashboards, ML features.</span>
      </div>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Side-by-Side Comparison</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Aspect</th><th>Kimball</th><th>Medallion</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>What it defines</strong></td><td>Data <em>modeling</em> methodology</td><td>Data <em>flow / pipeline</em> pattern</td></tr>
        <tr><td><strong>Scope</strong></td><td>Final analytical layer only</td><td>Entire pipeline (raw ‚Üí consumption)</td></tr>
        <tr><td><strong>Layers</strong></td><td>Staging ‚Üí Intermediate ‚Üí Marts</td><td>Bronze ‚Üí Silver ‚Üí Gold</td></tr>
        <tr><td><strong>Gold layer modeling</strong></td><td>‚≠ê Star schemas (fct_ + dim_)</td><td>Flexible ‚Äî could be star, OBT, wide tables, or ML features</td></tr>
        <tr><td><strong>Data quality approach</strong></td><td>Conformed dimensions + tests</td><td>Progressive refinement across layers</td></tr>
        <tr><td><strong>SCD handling</strong></td><td>Explicit (Type 1, 2, 3, 6)</td><td>Time travel / versioning via Delta Lake</td></tr>
        <tr><td><strong>Best for</strong></td><td>BI / analytics / dashboards</td><td>Mixed workloads (BI + ML + streaming)</td></tr>
        <tr><td><strong>Storage paradigm</strong></td><td>Data warehouse (Snowflake, BQ)</td><td>Data lakehouse (Databricks, Delta)</td></tr>
        <tr><td><strong>Schema enforcement</strong></td><td>Schema-on-write (strict)</td><td>Schema-on-read at Bronze, stricter at Gold</td></tr>
        <tr><td><strong>Handles unstructured data</strong></td><td>No ‚Äî structured / tabular only</td><td>Yes ‚Äî images, logs, JSON, Parquet at Bronze</td></tr>
        <tr><td><strong>Community/tooling</strong></td><td>dbt, Snowflake, BigQuery, Looker</td><td>Databricks, Delta Lake, Apache Spark</td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout callout-key" style="margin-top:2rem;">
    <h4>üîë The Key Insight: They Solve Different Problems</h4>
    <p>Kimball answers: <strong>"How should the final tables look?"</strong> Medallion answers: <strong>"How should data flow from raw to refined?"</strong> They operate at different levels of the stack. The best modern architectures use <strong>both together</strong> ‚Äî Medallion for pipeline organization, Kimball for the Gold layer's data model.</p>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">How They Work Together ‚Äî The Best of Both Worlds</h4>
  <div class="diagram-container">
    <div class="diagram-title">Combined Architecture (Recommended)</div>
    <div class="flow-row" style="margin:1.5rem 0;">
      <div class="flow-box" style="background:var(--accent-orange-dim);color:var(--accent-orange);border-color:rgba(249,115,22,0.3);">
        <strong>ü•â Bronze</strong><br><span style="font-size:0.78rem;">Raw / Staging<br>stg_shopify__orders</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-blue-dim);color:var(--accent-blue);border-color:rgba(59,130,246,0.3);">
        <strong>ü•à Silver</strong><br><span style="font-size:0.78rem;">Intermediate / Clean<br>int_orders__enriched</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-gold-dim);color:var(--accent-gold);border-color:rgba(240,197,91,0.3);">
        <strong>ü•á Gold = ‚≠ê Kimball Stars</strong><br><span style="font-size:0.78rem;">dim_customer + fct_order_lines<br>Star schemas for BI</span>
      </div>
    </div>
    <p style="color:var(--text-secondary);font-size:0.9rem;margin-top:1rem;">Medallion provides the <em>pipeline structure</em>. Kimball provides the <em>modeling discipline</em> for the Gold layer.</p>
  </div>

  <div class="code-block" style="margin-top:1.5rem;">
    <div class="code-label">dbt Project = Medallion + Kimball</div>
<pre>
<span class="cm">models/</span>
<span class="cm">‚îú‚îÄ‚îÄ bronze/</span>               <span class="cm">‚Üê Medallion Bronze = dbt staging</span>
<span class="cm">‚îÇ   ‚îú‚îÄ‚îÄ stg_shopify__orders.sql</span>
<span class="cm">‚îÇ   ‚îî‚îÄ‚îÄ stg_stripe__payments.sql</span>
<span class="cm">‚îú‚îÄ‚îÄ silver/</span>               <span class="cm">‚Üê Medallion Silver = dbt intermediate</span>
<span class="cm">‚îÇ   ‚îú‚îÄ‚îÄ int_orders__enriched.sql</span>
<span class="cm">‚îÇ   ‚îî‚îÄ‚îÄ int_customers__deduplicated.sql</span>
<span class="cm">‚îî‚îÄ‚îÄ gold/</span>                 <span class="cm">‚Üê Medallion Gold = ‚≠ê KIMBALL STAR SCHEMAS</span>
<span class="cm">    ‚îú‚îÄ‚îÄ dim_date.sql</span>
<span class="cm">    ‚îú‚îÄ‚îÄ dim_customer.sql</span>         <span class="cm">‚Üê Conformed dimension (SCD Type 2)</span>
<span class="cm">    ‚îú‚îÄ‚îÄ dim_product.sql</span>          <span class="cm">‚Üê Conformed dimension</span>
<span class="cm">    ‚îú‚îÄ‚îÄ fct_order_lines.sql</span>      <span class="cm">‚Üê Transaction fact</span>
<span class="cm">    ‚îî‚îÄ‚îÄ fct_inventory_daily.sql</span>  <span class="cm">‚Üê Periodic snapshot fact</span>
</pre>
  </div>

  <div class="grid-3" style="margin-top:2rem;">
    <div class="card teal">
      <h3>When to Use Kimball Alone</h3>
      <ul class="clean-list">
        <li>Cloud warehouse (Snowflake, BigQuery)</li>
        <li>Primary consumers are BI/analysts</li>
        <li>Structured, tabular data only</li>
        <li>dbt-centric workflow</li>
      </ul>
    </div>
    <div class="card purple">
      <h3>When to Use Medallion Alone</h3>
      <ul class="clean-list">
        <li>Data lakehouse (Databricks, Delta Lake)</li>
        <li>Heavy ML / data science workloads</li>
        <li>Unstructured data (logs, images, JSON)</li>
        <li>Gold layer doesn't need star schemas</li>
      </ul>
    </div>
    <div class="card gold">
      <h3>When to Combine Both ‚≠ê</h3>
      <ul class="clean-list">
        <li>Modern analytics team (most teams!)</li>
        <li>Mixed workloads: BI + ML</li>
        <li>Need pipeline discipline AND modeling rigor</li>
        <li>dbt + Snowflake / BigQuery / Databricks</li>
      </ul>
    </div>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Assembly Line vs. Product Design</div>
    <p><strong>Medallion</strong> is the assembly line ‚Äî it defines <em>how raw materials progress</em> through the factory: receiving dock (Bronze), quality inspection and cleaning (Silver), final assembly (Gold). <strong>Kimball</strong> is the product design blueprint ‚Äî it defines <em>what the finished product looks like</em>: a star-shaped schema optimized for the end user. You need both: the best assembly line in the world produces junk without a good blueprint, and the best blueprint is useless without a manufacturing process to build it.</p>
  </div>
</section>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEW ‚Äî DATA VAULT COMPARISON ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="data-vault">
  <div class="section-header">
    <div class="section-number">Section 05</div>
    <h2 class="section-title">Kimball vs. Data Vault</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">The third major modeling paradigm ‚Äî designed for auditability and agility at enterprise scale.</p>
  </div>

  <div class="grid-2">
    <div class="card gold card-wide">
      <div class="card-icon" style="background:var(--accent-gold-dim);color:var(--accent-gold);">‚≠ê</div>
      <h3>Kimball Dimensional Model</h3>
      <ul class="clean-list">
        <li><strong>Core pattern:</strong> Star schemas (facts + dimensions)</li>
        <li><strong>Design driver:</strong> Business process analysis</li>
        <li><strong>Optimized for:</strong> Query performance &amp; analyst usability</li>
        <li><strong>Loading:</strong> Transform-heavy (get it right before loading)</li>
        <li><strong>History:</strong> SCD Types (explicit design choice per attribute)</li>
        <li><strong>Schema changes:</strong> Requires careful refactoring</li>
      </ul>
    </div>
    <div class="card teal card-wide">
      <div class="card-icon" style="background:var(--accent-teal-dim);color:var(--accent-teal);">üèõÔ∏è</div>
      <h3>Data Vault 2.0</h3>
      <ul class="clean-list">
        <li><strong>Core pattern:</strong> Hubs, Links, and Satellites</li>
        <li><strong>Design driver:</strong> Business keys &amp; relationships</li>
        <li><strong>Optimized for:</strong> Auditability, agility &amp; parallel loading</li>
        <li><strong>Loading:</strong> Insert-only (never update, always append)</li>
        <li><strong>History:</strong> Automatic ‚Äî every change creates a new satellite row</li>
        <li><strong>Schema changes:</strong> Add new satellites without touching existing tables</li>
      </ul>
    </div>
  </div>

  <div class="diagram-container" style="margin-top:2rem;">
    <div class="diagram-title">Data Vault Building Blocks</div>
    <div class="grid-3" style="margin:1.5rem 0;">
      <div class="card blue" style="text-align:center;">
        <h3 style="color:var(--accent-blue);">üîµ Hub</h3>
        <p>Business key + surrogate key + load timestamp. Represents a core business entity (Customer, Product, Order). <strong>Never changes</strong> once inserted.</p>
        <div class="code-block" style="margin-top:0.75rem;"><pre>hub_customer
‚îú‚îÄ‚îÄ hub_customer_key (hash)
‚îú‚îÄ‚îÄ customer_bk  (business key)
‚îú‚îÄ‚îÄ load_date
‚îî‚îÄ‚îÄ record_source</pre></div>
      </div>
      <div class="card purple" style="text-align:center;">
        <h3 style="color:var(--accent-purple);">üîó Link</h3>
        <p>Captures <strong>relationships</strong> between Hubs. Many-to-many by default. Also insert-only.</p>
        <div class="code-block" style="margin-top:0.75rem;"><pre>link_order_customer
‚îú‚îÄ‚îÄ link_order_cust_key (hash)
‚îú‚îÄ‚îÄ hub_order_key (FK)
‚îú‚îÄ‚îÄ hub_customer_key (FK)
‚îú‚îÄ‚îÄ load_date
‚îî‚îÄ‚îÄ record_source</pre></div>
      </div>
      <div class="card rose" style="text-align:center;">
        <h3 style="color:var(--accent-rose);">üõ∞Ô∏è Satellite</h3>
        <p>Stores <strong>descriptive attributes</strong> + history. New row on every change. Attached to a Hub or Link.</p>
        <div class="code-block" style="margin-top:0.75rem;"><pre>sat_customer_details
‚îú‚îÄ‚îÄ hub_customer_key (FK)
‚îú‚îÄ‚îÄ load_date (PK part)
‚îú‚îÄ‚îÄ customer_name
‚îú‚îÄ‚îÄ email, city, segment
‚îú‚îÄ‚îÄ hash_diff
‚îî‚îÄ‚îÄ record_source</pre></div>
      </div>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Detailed Comparison</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Aspect</th><th>Kimball</th><th>Data Vault 2.0</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>Core tables</strong></td><td>Facts + Dimensions</td><td>Hubs + Links + Satellites</td></tr>
        <tr><td><strong>Primary key strategy</strong></td><td>Integer surrogate keys</td><td>Hash keys (MD5/SHA) of business keys</td></tr>
        <tr><td><strong>Normalization</strong></td><td>Denormalized dimensions</td><td>Highly normalized (3NF+)</td></tr>
        <tr><td><strong>History tracking</strong></td><td>Explicit SCD types per attribute</td><td>Automatic ‚Äî every satellite insert is history</td></tr>
        <tr><td><strong>Load pattern</strong></td><td>Upsert / merge (SCD logic)</td><td>Insert-only (append, never update)</td></tr>
        <tr><td><strong>Parallel loading</strong></td><td>Dimensions before facts (dependency)</td><td>Hubs, Links, Satellites load independently</td></tr>
        <tr><td><strong>Query complexity</strong></td><td>Simple ‚Äî 1 fact + N dims via FK</td><td>Complex ‚Äî many joins through Hubs/Links/Sats</td></tr>
        <tr><td><strong>End-user friendliness</strong></td><td>‚≠ê Excellent ‚Äî analysts self-serve</td><td>Needs a "Business Vault" or presentation layer</td></tr>
        <tr><td><strong>Agility to source changes</strong></td><td>Medium ‚Äî schema changes ripple</td><td>‚≠ê High ‚Äî add new Satellites without impact</td></tr>
        <tr><td><strong>Auditability</strong></td><td>Good (with SCD2 + snapshots)</td><td>‚≠ê Excellent ‚Äî full lineage by design</td></tr>
        <tr><td><strong>Best for</strong></td><td>BI &amp; analytics teams</td><td>Enterprise data integration, regulated industries</td></tr>
        <tr><td><strong>Typical pairing</strong></td><td>dbt + Snowflake/BigQuery + Looker</td><td>dbt (with dbtvault) + Snowflake + presentation layer</td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout callout-key" style="margin-top:2rem;">
    <h4>üîë Key Insight: Different Layers, Not Competitors</h4>
    <p>In practice, many enterprise teams use <strong>Data Vault as the integration layer</strong> (raw vault = single source of truth with full history) and then build <strong>Kimball star schemas as the presentation layer</strong> on top for BI consumption. Data Vault feeds Kimball ‚Äî they're complementary, not mutually exclusive.</p>
  </div>

  <div class="grid-3" style="margin-top:2rem;">
    <div class="card gold">
      <h3>Choose Kimball When</h3>
      <ul class="clean-list">
        <li>Primary consumers are analysts/BI</li>
        <li>Speed to delivery matters most</li>
        <li>Team is small and pragmatic</li>
        <li>Source systems are relatively stable</li>
      </ul>
    </div>
    <div class="card teal">
      <h3>Choose Data Vault When</h3>
      <ul class="clean-list">
        <li>Regulatory audit trails required</li>
        <li>Many source systems changing often</li>
        <li>Enterprise-scale with parallel teams</li>
        <li>Full history of everything is non-negotiable</li>
      </ul>
    </div>
    <div class="card purple">
      <h3>Combine Both When</h3>
      <ul class="clean-list">
        <li>Large org with mixed needs</li>
        <li>Raw Vault for integration/audit</li>
        <li>Business Vault for business rules</li>
        <li>Kimball stars as presentation layer</li>
      </ul>
    </div>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Filing Systems</div>
    <p><strong>Kimball</strong> is like organizing files by <em>project</em>: everything for "Q4 Sales" in one folder ‚Äî fast to find, but if a client appears in multiple projects, their info is duplicated. <strong>Data Vault</strong> is like organizing by <em>entity</em>: one folder per client, one per project, with cross-references linking them ‚Äî perfectly auditable, but you need to follow links to assemble a complete picture. Most large offices use both: entity files for compliance, project folders for daily work.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 04 ‚Äî PROS & CONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="pros-cons">
  <div class="section-header">
    <div class="section-number">Section 06</div>
    <h2 class="section-title">Pros &amp; Cons of Kimball Architecture</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">An honest evaluation ‚Äî every architecture has tradeoffs. Knowing them upfront helps you make the right choice.</p>
  </div>

  <div class="comparison-grid">
    <div class="card teal card-wide">
      <h3 style="color:var(--accent-teal);">‚úÖ Advantages</h3>
      <ul class="clean-list">
        <li><strong>Fast time-to-value:</strong> Deliver a usable data mart in weeks, not months. Business sees ROI immediately.</li>
        <li><strong>Intuitive for business users:</strong> Star schemas are easy to understand ‚Äî analysts write their own queries without deep SQL expertise.</li>
        <li><strong>Blazing query performance:</strong> Denormalized dimensions + columnar databases = minimal joins, maximum scan speed. Ideal for interactive BI dashboards.</li>
        <li><strong>Incremental delivery:</strong> Build one star at a time. No need to model the entire enterprise before shipping value.</li>
        <li><strong>Conformed dimensions ensure consistency:</strong> Shared vocabularies (dim_customer, dim_date) across all marts eliminate the "which number is right?" problem.</li>
        <li><strong>AI/LLM-friendly:</strong> Simple, descriptive schemas are ideal for text-to-SQL, semantic layers, and AI-powered analytics.</li>
        <li><strong>Battle-tested at scale:</strong> 30+ years of proven methodology. Snowflake, BigQuery, Redshift are all optimized for star schemas.</li>
        <li><strong>Excellent with dbt:</strong> The dbt project structure (staging ‚Üí intermediate ‚Üí marts) maps 1:1 to Kimball's methodology. Massive community support.</li>
      </ul>
    </div>
    <div class="card rose card-wide">
      <h3 style="color:var(--accent-rose);">‚ö†Ô∏è Disadvantages</h3>
      <ul class="clean-list">
        <li><strong>Redundant data in dimensions:</strong> Denormalization means repeating "Electronics" 50,000 times in dim_product. Storage cost is real (though cheap on modern warehouses).</li>
        <li><strong>ETL complexity for SCDs:</strong> SCD Type 2 is powerful but operationally complex ‚Äî managing surrogate keys, versioned rows, and date ranges requires careful engineering.</li>
        <li><strong>Schema changes are costly:</strong> Adding a new dimension to an existing fact table means altering the fact, backfilling FKs, and updating all downstream dashboards.</li>
        <li><strong>Not ideal for exploratory / ad-hoc ML:</strong> Data scientists often want wide, flat, raw datasets ‚Äî star schemas add join overhead for non-BI workloads.</li>
        <li><strong>Upfront design effort:</strong> The 4-step process and Bus Matrix require disciplined requirements gathering. Rushing this leads to rework.</li>
        <li><strong>Risk of "siloed marts" without governance:</strong> Without enforcing conformed dimensions, teams build incompatible marts ‚Äî exactly the problem Kimball set out to solve.</li>
        <li><strong>Semi-additive measures trip people up:</strong> Account balances, inventory levels, and MRR are commonly mishandled, leading to incorrect reports.</li>
        <li><strong>Less flexible for rapidly changing requirements:</strong> If the grain or business process definition changes frequently, refactoring a star schema is more painful than refactoring a normalized model.</li>
      </ul>
    </div>
  </div>

  <div class="callout callout-info" style="margin-top:2rem;">
    <h4>When Kimball Shines Brightest</h4>
    <p>Kimball is the optimal choice when: (1) your primary consumers are <strong>BI dashboards and business analysts</strong>, (2) you want <strong>fast, iterative delivery</strong>, (3) your data team uses <strong>dbt + modern cloud warehouse</strong>, and (4) you value <strong>query performance and user self-service</strong> above all else. It's the dominant architecture in modern analytics for a reason.</p>
  </div>

  <div class="callout callout-warning">
    <h4>When to Consider Alternatives</h4>
    <p>If your primary workloads are ML model training, unstructured data processing, real-time event streaming, or you operate in a heavily regulated industry requiring strict audit trails on normalized data ‚Äî <strong>a hybrid approach or lakehouse</strong> may serve you better. Most modern teams combine multiple paradigms.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Restaurant Kitchen Layout</div>
    <p>A Kimball star schema is like a <strong>well-organized restaurant kitchen</strong>: ingredients are pre-prepped and arranged at each station (mise en place = denormalized dimensions), so when an order comes in, the chef assembles the dish fast. The tradeoff? Setup takes time, and if the menu changes dramatically, you reorganize the entire kitchen. A normalized model is like storing everything in a raw pantry ‚Äî maximally flexible, but every order requires finding and measuring each ingredient from scratch.</p>
  </div>
</section>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEW ‚Äî KIMBALL LIFECYCLE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="kimball-lifecycle">
  <div class="section-header">
    <div class="section-number">Section 07</div>
    <h2 class="section-title">The Kimball Lifecycle</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">The full project methodology ‚Äî dimensional modeling is just one piece of a larger framework.</p>
  </div>

  <div class="callout callout-info">
    <h4>Beyond Just Data Modeling</h4>
    <p>Kimball's methodology isn't only about star schemas. It's a <strong>complete project lifecycle</strong> covering everything from requirements gathering to deployment and maintenance. The 4-step design process (next section) fits inside the "Dimensional Modeling" track of this broader framework.</p>
  </div>

  <div class="diagram-container" style="margin-top:2rem;">
    <div class="diagram-title">Kimball Lifecycle ‚Äî Three Parallel Tracks</div>
    <div class="flow-row" style="margin:1.5rem 0;flex-wrap:wrap;justify-content:center;">
      <div class="flow-box" style="background:var(--accent-gold-dim);color:var(--accent-gold);border-color:rgba(240,197,91,0.3);min-width:160px;">
        <strong>üìã Program/Project<br>Planning</strong>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-blue-dim);color:var(--accent-blue);border-color:rgba(59,130,246,0.3);min-width:160px;">
        <strong>üîç Business Requirements<br>Definition</strong>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-purple-dim);color:var(--accent-purple);border-color:rgba(167,139,250,0.3);min-width:280px;text-align:left;padding:1rem;">
        <strong>Three Parallel Tracks:</strong><br>
        <span style="font-size:0.8rem;">üîµ Technology Track<br>üü° Data Track (Dimensional Modeling + ETL)<br>üü¢ BI Application Track</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-teal-dim);color:var(--accent-teal);border-color:rgba(45,212,191,0.3);min-width:160px;">
        <strong>üöÄ Deployment</strong>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-rose-dim);color:var(--accent-rose);border-color:rgba(251,113,133,0.3);min-width:160px;">
        <strong>üîÑ Growth &amp;<br>Maintenance</strong>
      </div>
    </div>
  </div>

  <div class="grid-2" style="margin-top:2rem;">
    <div class="card gold card-wide">
      <h3 style="color:var(--accent-gold);">üìã Phase 1: Program/Project Planning</h3>
      <ul class="clean-list">
        <li><strong>Assess readiness:</strong> Does the org have executive sponsorship, budget, and the right team?</li>
        <li><strong>Scope the iteration:</strong> Pick 1‚Äì2 business processes for the first release ‚Äî don't boil the ocean</li>
        <li><strong>Build the Bus Matrix:</strong> Map all processes √ó dimensions to plan the long-term roadmap</li>
        <li><strong>Prioritize:</strong> Start with the process that has the highest business impact + data availability</li>
      </ul>
    </div>
    <div class="card blue card-wide">
      <h3 style="color:var(--accent-blue);">üîç Phase 2: Business Requirements</h3>
      <ul class="clean-list">
        <li><strong>Interview business users</strong> ‚Äî not IT. Ask: "What decisions do you make? What data do you wish you had?"</li>
        <li><strong>Identify KPIs:</strong> Revenue, conversion rate, churn, inventory turns ‚Äî these become your <em>facts</em></li>
        <li><strong>Identify analysis dimensions:</strong> "By region, by product, by time" ‚Äî these become your <em>dimensions</em></li>
        <li><strong>Document data sources:</strong> Which systems hold this data? What's the refresh frequency?</li>
      </ul>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">The Three Parallel Tracks</h4>
  <div class="grid-3">
    <div class="card blue">
      <h3 style="color:var(--accent-blue);">üîµ Technology Track</h3>
      <ul class="clean-list">
        <li><strong>Architecture design:</strong> Choose cloud warehouse, ETL tool, BI platform</li>
        <li><strong>Infrastructure setup:</strong> Environments (dev/staging/prod), security, networking</li>
        <li><strong>Modern stack example:</strong> Snowflake + dbt + Looker + Fivetran</li>
        <li><strong>Key decision:</strong> Build vs. buy for each component</li>
      </ul>
    </div>
    <div class="card gold">
      <h3 style="color:var(--accent-gold);">üü° Data Track ‚≠ê</h3>
      <ul class="clean-list">
        <li><strong>Dimensional modeling:</strong> The 4-step process (next section!) ‚Äî this is the heart of Kimball</li>
        <li><strong>Physical design:</strong> Partitioning, clustering, materialization strategy</li>
        <li><strong>ETL/ELT design:</strong> Extraction, staging, transformation, loading, error handling</li>
        <li><strong>Testing &amp; validation:</strong> Data quality checks, reconciliation with source</li>
      </ul>
    </div>
    <div class="card teal">
      <h3 style="color:var(--accent-teal);">üü¢ BI Application Track</h3>
      <ul class="clean-list">
        <li><strong>Dashboard design:</strong> Mockups, KPI definitions, user personas</li>
        <li><strong>Semantic layer:</strong> Define metrics, hierarchies, drill-paths in the BI tool</li>
        <li><strong>User acceptance testing:</strong> Business users validate that numbers match expectations</li>
        <li><strong>Training &amp; rollout:</strong> User documentation, workshops, support channels</li>
      </ul>
    </div>
  </div>

  <div class="grid-2" style="margin-top:1.5rem;">
    <div class="card purple card-wide">
      <h3 style="color:var(--accent-purple);">üöÄ Phase 3: Deployment</h3>
      <ul class="clean-list">
        <li>Production cutover with monitoring and alerting</li>
        <li>Parallel run: compare old reports vs. new for a validation period</li>
        <li>User training workshops and self-service documentation</li>
        <li>Establish SLAs for data freshness and query performance</li>
      </ul>
    </div>
    <div class="card rose card-wide">
      <h3 style="color:var(--accent-rose);">üîÑ Phase 4: Growth &amp; Maintenance</h3>
      <ul class="clean-list">
        <li><strong>Add new stars:</strong> Pick the next process from the Bus Matrix and iterate</li>
        <li><strong>Evolve existing models:</strong> Add dimensions, new measures, handle schema changes</li>
        <li><strong>Performance tuning:</strong> Monitor query times, optimize materializations</li>
        <li><strong>Data governance:</strong> Ownership, documentation, lineage, access control</li>
      </ul>
    </div>
  </div>

  <div class="callout callout-key" style="margin-top:2rem;">
    <h4>üîë Modern Adaptation</h4>
    <p>Kimball's original lifecycle assumed waterfall-style multi-month projects. Modern teams run it in <strong>agile sprints</strong>: 2-week iterations, each delivering a tested, documented increment. dbt + CI/CD makes this natural ‚Äî every PR is a small lifecycle iteration: model ‚Üí test ‚Üí document ‚Üí deploy.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Building a House</div>
    <p>The Kimball Lifecycle is like a construction project. <strong>Planning</strong> = choosing the neighborhood and lot (scope). <strong>Requirements</strong> = the architect interviewing the family about bedrooms, kitchen style, budget. Then three crews work in parallel: <strong>structural</strong> (foundation, framing = technology), <strong>interior design</strong> (layout, fixtures = dimensional modeling + ETL), and <strong>landscaping</strong> (curb appeal = BI dashboards). You don't wait for the kitchen to be done before starting the roof ‚Äî they progress together.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî FOUR-STEP PROCESS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="four-step">
  <div class="section-header">
    <div class="section-number">Section 08</div>
    <h2 class="section-title">Kimball's 4-Step Design Process</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Every dimensional model starts with these four sequential decisions.</p>
  </div>
  <div class="process-steps">
    <div class="process-step">
      <div class="step-num">1</div>
      <div class="step-content">
        <h4>Select the Business Process</h4>
        <p>Identify the operational activity ‚Äî a <strong>repeatable event</strong>: taking orders, processing claims, handling returns. Each produces a single fact table. Don't model a department; model what they <em>do</em>.</p>
        <p style="margin-top:0.5rem;"><em style="color:var(--accent-gold);">Example:</em> "We want to analyze retail sales transactions."</p>
      </div>
    </div>
    <div class="process-step">
      <div class="step-num">2</div>
      <div class="step-content">
        <h4>Declare the Grain</h4>
        <p>The <strong>most atomic level of detail</strong> each fact row represents. Always err toward the most granular grain ‚Äî you can aggregate up, but never drill down past your grain.</p>
        <p style="margin-top:0.5rem;"><em style="color:var(--accent-gold);">Example:</em> "One row per individual line item on a sales receipt."</p>
      </div>
    </div>
    <div class="process-step">
      <div class="step-num">3</div>
      <div class="step-content">
        <h4>Identify the Dimensions</h4>
        <p>Ask: <strong>"How do users want to slice, dice, filter, and group the facts?"</strong> Each answer becomes a dimension table.</p>
        <p style="margin-top:0.5rem;"><em style="color:var(--accent-gold);">Example:</em> "By date, product, store, customer, cashier, and payment method."</p>
      </div>
    </div>
    <div class="process-step">
      <div class="step-num">4</div>
      <div class="step-content">
        <h4>Identify the Facts (Measures)</h4>
        <p>The <strong>numeric measurements</strong> from the process. Each must be true at the declared grain.</p>
        <p style="margin-top:0.5rem;"><em style="color:var(--accent-gold);">Example:</em> "quantity_sold, unit_price, extended_price, discount_amount, net_revenue."</p>
      </div>
    </div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Designing a Sports Scoreboard</div>
    <p><strong>Step 1</strong>: We're tracking basketball games. <strong>Step 2</strong>: Each row = one shot attempt by one player in one game. <strong>Step 3</strong>: Player, Team, Arena, Game Date, Shot Type, Quarter. <strong>Step 4</strong>: points_scored, is_made, distance_from_basket, shot_clock_remaining. Now any analyst can answer "What's LeBron's 3-point percentage in away games during the 4th quarter?" with a simple GROUP BY.</p>
  </div>
</section>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEW ‚Äî BUS MATRIX ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="bus-matrix">
  <div class="section-header">
    <div class="section-number">Section 09</div>
    <h2 class="section-title">The Enterprise Bus Matrix</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">The master planning tool ‚Äî a single grid that maps your entire data warehouse roadmap.</p>
  </div>

  <div class="callout callout-info">
    <h4>What Is the Bus Matrix?</h4>
    <p>A grid where <strong>rows = business processes</strong> (each becomes a fact table) and <strong>columns = dimensions</strong>. Checkmarks show which dimensions participate in each process. Shared columns are <strong>conformed dimensions</strong> ‚Äî the glue that lets you query across multiple stars. It's both a <em>planning tool</em> (what to build and in what order) and a <em>communication tool</em> (showing stakeholders how everything connects).</p>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Example: E-Commerce Company Bus Matrix</h4>
  <div class="card blue card-wide">
    <table class="styled-table" style="font-size:0.82rem;">
      <thead>
        <tr>
          <th>Business Process (Fact)</th>
          <th>Date</th><th>Customer</th><th>Product</th><th>Store/<br>Channel</th><th>Employee</th><th>Promotion</th><th>Supplier</th><th>Warehouse</th>
        </tr>
      </thead>
      <tbody>
        <tr><td><strong>Online Orders</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td>‚úÖ</td></tr>
        <tr><td><strong>In-Store Sales</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td></td></tr>
        <tr><td><strong>Returns</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td></td><td>‚úÖ</td></tr>
        <tr><td><strong>Inventory Snapshots</strong></td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td></td><td></td><td>‚úÖ</td><td>‚úÖ</td></tr>
        <tr><td><strong>Purchase Orders</strong></td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td>‚úÖ</td><td>‚úÖ</td></tr>
        <tr><td><strong>Customer Support</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td></td><td></td></tr>
        <tr><td><strong>Marketing Campaigns</strong></td><td>‚úÖ</td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td></td></tr>
      </tbody>
    </table>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Reading the Bus Matrix</h4>
  <div class="grid-3">
    <div class="card gold">
      <h3>Read Across (Rows)</h3>
      <p>Each row defines one <strong>star schema</strong>. "Online Orders" connects to Date, Customer, Product, Channel, Promotion, and Warehouse dimensions.</p>
    </div>
    <div class="card teal">
      <h3>Read Down (Columns)</h3>
      <p>Columns with many checkmarks are <strong>conformed dimensions</strong>. Date (7/7 ‚úÖ) and Product (6/7 ‚úÖ) are the most shared ‚Äî build these first.</p>
    </div>
    <div class="card purple">
      <h3>Prioritize Delivery</h3>
      <p>Start with the row that has the <strong>highest business value + best data quality</strong>. Each new row reuses existing conformed dims, so delivery accelerates over time.</p>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">How to Build Your Bus Matrix</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Step</th><th>Action</th><th>Tip</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>1</strong></td><td>List all business processes (verbs: selling, shipping, returning, hiring)</td><td>Each process = one fact table = one row</td></tr>
        <tr><td><strong>2</strong></td><td>List all dimensions (nouns: customer, product, date, location)</td><td>Each dimension = one column</td></tr>
        <tr><td><strong>3</strong></td><td>Fill in the checkmarks ‚Äî which dimensions participate in each process?</td><td>Interview business users, not IT</td></tr>
        <tr><td><strong>4</strong></td><td>Identify conformed dimensions (columns with 3+ checkmarks)</td><td>These are your highest-priority builds</td></tr>
        <tr><td><strong>5</strong></td><td>Prioritize rows by: business value √ó data readiness √ó # of conformed dims reused</td><td>First star should reuse max conformed dims</td></tr>
        <tr><td><strong>6</strong></td><td>Iterate: build one star per sprint/cycle, growing the matrix over time</td><td>Each new star gets cheaper as dims are reused</td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout callout-warning" style="margin-top:2rem;">
    <h4>Common Bus Matrix Mistakes</h4>
    <p><strong>Too granular:</strong> Don't list "revenue" and "quantity" as separate rows ‚Äî those are <em>measures</em> within a single process. <strong>Too broad:</strong> Don't combine "online sales" and "in-store sales" into one row if they have different grains or dimensions. <strong>Missing processes:</strong> Don't forget non-revenue processes like inventory, support, and marketing ‚Äî these are often the most valuable for cross-functional analysis.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Airline Route Map</div>
    <p>The Bus Matrix is like an airline's route map. Each <strong>row</strong> is a flight route (business process). Each <strong>column</strong> is an airport (dimension). Checkmarks show which airports a route connects. <strong>Hub airports</strong> (conformed dimensions like Date and Customer) appear on almost every route ‚Äî invest in them first. Adding a new route is cheap if it connects existing hubs; building a new airport (non-conformed dimension) is expensive. The map lets the CEO see the whole network at a glance.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî STAR SCHEMA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="star-schema">
  <div class="section-header">
    <div class="section-number">Section 10</div>
    <h2 class="section-title">The Star Schema</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Kimball's signature model ‚Äî simple, intuitive, blazing fast.</p>
  </div>
  <div class="diagram-container">
    <div class="diagram-title">Star Schema ‚Äî Retail Sales Example</div>
    <svg viewBox="0 0 700 500" xmlns="http://www.w3.org/2000/svg" style="width:100%;max-width:700px;">
      <line x1="350" y1="250" x2="120" y2="80" stroke="rgba(240,197,91,0.3)" stroke-width="2" stroke-dasharray="6,4"/>
      <line x1="350" y1="250" x2="580" y2="80" stroke="rgba(240,197,91,0.3)" stroke-width="2" stroke-dasharray="6,4"/>
      <line x1="350" y1="250" x2="80" y2="350" stroke="rgba(240,197,91,0.3)" stroke-width="2" stroke-dasharray="6,4"/>
      <line x1="350" y1="250" x2="620" y2="350" stroke="rgba(240,197,91,0.3)" stroke-width="2" stroke-dasharray="6,4"/>
      <line x1="350" y1="250" x2="350" y2="460" stroke="rgba(240,197,91,0.3)" stroke-width="2" stroke-dasharray="6,4"/>
      <rect x="265" y="195" width="170" height="110" rx="12" fill="#1a2234" stroke="#f0c55b" stroke-width="2.5"/>
      <text x="350" y="222" text-anchor="middle" fill="#f0c55b" font-family="monospace" font-size="11" font-weight="700">FACT_SALES</text>
      <line x1="275" y1="232" x2="425" y2="232" stroke="rgba(240,197,91,0.3)"/>
      <text x="285" y="249" fill="#14b8a6" font-family="monospace" font-size="9">FK date_key</text>
      <text x="285" y="263" fill="#14b8a6" font-family="monospace" font-size="9">FK product_key</text>
      <text x="285" y="277" fill="#14b8a6" font-family="monospace" font-size="9">FK customer_key</text>
      <text x="285" y="291" fill="#f43f5e" font-family="monospace" font-size="9">$ revenue, qty</text>
      <rect x="40" y="30" width="160" height="100" rx="10" fill="#1a2234" stroke="#3b82f6" stroke-width="2"/>
      <text x="120" y="55" text-anchor="middle" fill="#3b82f6" font-family="monospace" font-size="10" font-weight="700">DIM_DATE</text>
      <line x1="50" y1="63" x2="190" y2="63" stroke="rgba(59,130,246,0.3)"/>
      <text x="58" y="79" fill="#f0c55b" font-family="monospace" font-size="9">PK date_key</text>
      <text x="58" y="93" fill="#94a3b8" font-family="monospace" font-size="9">full_date, month</text>
      <text x="58" y="107" fill="#94a3b8" font-family="monospace" font-size="9">quarter, year</text>
      <text x="58" y="121" fill="#94a3b8" font-family="monospace" font-size="9">is_weekend, is_holiday</text>
      <rect x="500" y="30" width="160" height="100" rx="10" fill="#1a2234" stroke="#3b82f6" stroke-width="2"/>
      <text x="580" y="55" text-anchor="middle" fill="#3b82f6" font-family="monospace" font-size="10" font-weight="700">DIM_PRODUCT</text>
      <line x1="510" y1="63" x2="650" y2="63" stroke="rgba(59,130,246,0.3)"/>
      <text x="518" y="79" fill="#f0c55b" font-family="monospace" font-size="9">PK product_key</text>
      <text x="518" y="93" fill="#94a3b8" font-family="monospace" font-size="9">product_name, brand</text>
      <text x="518" y="107" fill="#94a3b8" font-family="monospace" font-size="9">category, subcategory</text>
      <text x="518" y="121" fill="#94a3b8" font-family="monospace" font-size="9">color, unit_price</text>
      <rect x="10" y="300" width="150" height="100" rx="10" fill="#1a2234" stroke="#3b82f6" stroke-width="2"/>
      <text x="85" y="325" text-anchor="middle" fill="#3b82f6" font-family="monospace" font-size="10" font-weight="700">DIM_STORE</text>
      <line x1="20" y1="333" x2="150" y2="333" stroke="rgba(59,130,246,0.3)"/>
      <text x="28" y="349" fill="#f0c55b" font-family="monospace" font-size="9">PK store_key</text>
      <text x="28" y="363" fill="#94a3b8" font-family="monospace" font-size="9">store_name, city</text>
      <text x="28" y="377" fill="#94a3b8" font-family="monospace" font-size="9">state, region</text>
      <text x="28" y="391" fill="#94a3b8" font-family="monospace" font-size="9">sq_footage</text>
      <rect x="540" y="300" width="155" height="100" rx="10" fill="#1a2234" stroke="#3b82f6" stroke-width="2"/>
      <text x="617" y="325" text-anchor="middle" fill="#3b82f6" font-family="monospace" font-size="10" font-weight="700">DIM_CUSTOMER</text>
      <line x1="550" y1="333" x2="685" y2="333" stroke="rgba(59,130,246,0.3)"/>
      <text x="558" y="349" fill="#f0c55b" font-family="monospace" font-size="9">PK customer_key</text>
      <text x="558" y="363" fill="#94a3b8" font-family="monospace" font-size="9">full_name, email</text>
      <text x="558" y="377" fill="#94a3b8" font-family="monospace" font-size="9">segment, loyalty_tier</text>
      <text x="558" y="391" fill="#94a3b8" font-family="monospace" font-size="9">city, country</text>
      <rect x="270" y="410" width="160" height="85" rx="10" fill="#1a2234" stroke="#3b82f6" stroke-width="2"/>
      <text x="350" y="435" text-anchor="middle" fill="#3b82f6" font-family="monospace" font-size="10" font-weight="700">DIM_PROMOTION</text>
      <line x1="280" y1="443" x2="420" y2="443" stroke="rgba(59,130,246,0.3)"/>
      <text x="288" y="459" fill="#f0c55b" font-family="monospace" font-size="9">PK promo_key</text>
      <text x="288" y="473" fill="#94a3b8" font-family="monospace" font-size="9">promo_name, type</text>
      <text x="288" y="487" fill="#94a3b8" font-family="monospace" font-size="9">discount_pct, channel</text>
    </svg>
  </div>
  <div class="grid-2" style="margin-top:2rem;">
    <div class="card teal"><h3>Why "Star"?</h3><p>Central fact table with dimension tables radiating outward ‚Äî it looks like a star. <strong>At most one join</strong> to get from any dimension to the fact table. No cascading joins, no confusion.</p></div>
    <div class="card gold"><h3>Performance Benefits</h3><p>Modern columnar databases (Snowflake, BigQuery, Redshift) scan fact tables at blazing speed, and small dimension tables fit comfortably in memory for hash joins. Denormalization trades minor storage for massive query performance.</p></div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî SNOWFLAKE SCHEMA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="snowflake-schema">
  <div class="section-header">
    <div class="section-number">Section 11</div>
    <h2 class="section-title">The Snowflake Schema</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">When dimension tables are further normalized into sub-tables.</p>
  </div>
  <div class="grid-2">
    <div class="card blue"><h3>What Makes It a "Snowflake"?</h3><p>A snowflake starts as a star but <strong>normalizes the dimensions</strong> ‚Äî breaking out hierarchical data into separate tables. Instead of <code>brand</code> and <code>category</code> as columns in dim_product, you create separate <code>dim_brand</code> and <code>dim_category</code> tables. The result branches out like a snowflake.</p></div>
    <div class="card purple"><h3>Tradeoffs</h3><table class="styled-table"><thead><tr><th>Aspect</th><th>Star</th><th>Snowflake</th></tr></thead><tbody><tr><td>Joins</td><td>Fewer</td><td>More</td></tr><tr><td>Query simplicity</td><td>Simpler</td><td>More complex</td></tr><tr><td>Storage</td><td>More</td><td>Less</td></tr><tr><td>Kimball's pick</td><td>‚úÖ Preferred</td><td>‚ö†Ô∏è Sparingly</td></tr></tbody></table></div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Your Contact Book</div>
    <p><strong>Star</strong> = Contact card with everything on it: name, phone, email, company name, company address. Flat and easy. <strong>Snowflake</strong> = Contact card with name and phone, but "company" is a hyperlink to a separate Company Card, which links to an Industry Card. More organized, less duplication, but you click through to get the full picture.</p>
  </div>
  <div class="callout callout-warning">
    <h4>Kimball's Preference</h4>
    <p>Kimball generally <strong>discourages snowflaking</strong>. Space savings from normalizing dimension tables are negligible compared to the fact table. Extra joins hurt query performance and user comprehension. Snowflake only when the dimension is genuinely enormous (millions of rows).</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî SCDs ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="scd">
  <div class="section-header">
    <div class="section-number">Section 12</div>
    <h2 class="section-title">Slowly Changing Dimensions (SCDs)</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">What happens when a customer moves, or a product gets re-categorized?</p>
  </div>
  <div class="grid-2">
    <div class="card gold card-wide">
      <div class="level-badge level-simple">Type 1 ‚Äî Overwrite</div>
      <h3>SCD Type 1</h3>
      <p><strong>Update old value</strong> with new. No history preserved. Dimension always reflects current state.</p>
      <p style="margin-top:0.5rem;"><strong>Use when:</strong> Correcting typos, updating non-analytical attributes.</p>
      <p style="margin-top:0.5rem;"><strong>Risk:</strong> All historical facts appear with the new value.</p>
    </div>
    <div class="card blue card-wide">
      <div class="level-badge level-medium">Type 2 ‚Äî Add New Row (Most Important!)</div>
      <h3>SCD Type 2</h3>
      <p>Create a <strong>new row</strong> with a new surrogate key. Old row gets <code>is_current = false</code> and an <code>end_date</code>. Fully preserves history.</p>
      <div class="code-block" style="margin-top:1rem;">
<pre>
<span class="cm">-- Customer moves from Munich ‚Üí Berlin</span>
<span class="cm">-- BEFORE: 1 row</span>
<span class="cm">-- key=42, city='Munich', is_current=true, start='2020-01-01', end='9999-12-31'</span>

<span class="cm">-- AFTER: 2 rows</span>
<span class="cm">-- key=42, city='Munich', is_current=false, start='2020-01-01', end='2024-06-30'</span>
<span class="cm">-- key=99, city='Berlin', is_current=true,  start='2024-07-01', end='9999-12-31'</span>
</pre>
      </div>
    </div>
    <div class="card purple card-wide">
      <div class="level-badge level-advanced">Type 3 ‚Äî Add Column</div>
      <h3>SCD Type 3</h3>
      <p>Add a column for the <strong>previous value</strong>. Only tracks one level of change.</p>
      <p style="margin-top:0.5rem;"><code>current_city = 'Berlin'</code>, <code>previous_city = 'Munich'</code></p>
    </div>
    <div class="card rose card-wide">
      <div class="level-badge level-complex">Type 6 ‚Äî Hybrid (1+2+3)</div>
      <h3>SCD Type 6</h3>
      <p>Combines all three: new rows (Type 2), with current value overwritten on every row (Type 1), plus previous column (Type 3). Maximum flexibility.</p>
    </div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Phone Contact History</div>
    <p><strong>Type 1</strong> = Update friend's number; old one is gone. <strong>Type 2</strong> = Phone keeps every version: "Mobile (current)", "Mobile (old ‚Äî until June 2024)". <strong>Type 3</strong> = Shows "Current: 555-1234, Previous: 555-9876" ‚Äî just two slots. <strong>Type 6</strong> = Each version entry also shows the latest number for instant comparison.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONFORMED DIMENSIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="conformed-dims">
  <div class="section-header">
    <div class="section-number">Section 12B</div>
    <h2 class="section-title">Conformed Dimensions</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">One dimension, shared across every fact table ‚Äî the secret to cross-functional analytics</p>
  </div>

  <div class="card gold card-wide" style="margin-bottom:2rem;">
    <h3>What Is a Conformed Dimension?</h3>
    <p>A <strong>conformed dimension</strong> is a dimension table that is built once, maintained once, and reused identically across multiple fact tables. When <code>dim_date</code> appears in <code>fct_sales</code>, <code>fct_inventory</code>, and <code>fct_marketing</code>, the keys and attributes carry the <em>exact same meaning</em> everywhere ‚Äî enabling "drill across" queries that span business processes.</p>
    <p style="margin-top:1rem;">Ralph Kimball called conformed dimensions the <strong>"bus architecture"</strong> ‚Äî just like a hardware bus connects all components, conformed dimensions connect all fact tables into a coherent enterprise data warehouse.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî A Universal Passport</div>
    <p>Think of a conformed dimension like a passport. It's issued once (single source of truth), carries the same identity information everywhere, and is accepted at every border crossing (fact table). If each country issued its own incompatible ID, you'd have chaos ‚Äî that's what happens when dimensions aren't conformed.</p>
  </div>

  <!-- Visual Diagram with SVG Connection Lines -->
  <div class="diagram-container" style="padding:2rem;">
    <div class="diagram-title">Conformed Dimensions in Action</div>
    <div style="position:relative;max-width:1000px;margin:0 auto;min-height:520px;" id="conformedDiagram">
      
      <!-- SVG Connection Lines Layer -->
      <svg id="conformedSvg" style="position:absolute;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none;" preserveAspectRatio="none">
        <defs>
          <marker id="arrowSales" markerWidth="6" markerHeight="6" refX="6" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6" fill="none" stroke="#f97316" stroke-width="1"/></marker>
          <marker id="arrowInventory" markerWidth="6" markerHeight="6" refX="6" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6" fill="none" stroke="#14b8a6" stroke-width="1"/></marker>
          <marker id="arrowMarketing" markerWidth="6" markerHeight="6" refX="6" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6" fill="none" stroke="#a78bfa" stroke-width="1"/></marker>
        </defs>
        <!-- Lines will be drawn by JS -->
      </svg>

      <!-- Left Column: Dimensions -->
      <div style="position:absolute;left:0;top:0;width:30%;">
        <div style="font-family:'JetBrains Mono',monospace;font-size:0.7rem;text-transform:uppercase;letter-spacing:2px;color:var(--accent-blue);margin-bottom:0.75rem;text-align:center;">Shared Dimensions</div>

        <div id="cd-dim-date" style="background:var(--accent-blue-dim);border:1px solid rgba(59,130,246,0.3);border-radius:10px;padding:0.85rem;margin-bottom:0.75rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-blue);margin-bottom:0.35rem;">üìÖ dim_date</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">üîë date_key ¬∑ full_date ¬∑ quarter ¬∑ fiscal_year</div>
        </div>

        <div id="cd-dim-product" style="background:var(--accent-blue-dim);border:1px solid rgba(59,130,246,0.3);border-radius:10px;padding:0.85rem;margin-bottom:0.75rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-blue);margin-bottom:0.35rem;">üì¶ dim_product</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">üîë product_key ¬∑ product_name ¬∑ category ¬∑ brand</div>
        </div>

        <div id="cd-dim-customer" style="background:var(--accent-blue-dim);border:1px solid rgba(59,130,246,0.3);border-radius:10px;padding:0.85rem;margin-bottom:0.75rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-blue);margin-bottom:0.35rem;">üë§ dim_customer</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">üîë customer_key ¬∑ customer_name ¬∑ segment ¬∑ region</div>
        </div>

        <div id="cd-dim-store" style="background:var(--accent-blue-dim);border:1px solid rgba(59,130,246,0.3);border-radius:10px;padding:0.85rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-blue);margin-bottom:0.35rem;">üè™ dim_store</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">üîë store_key ¬∑ store_name ¬∑ city ¬∑ country</div>
        </div>
      </div>

      <!-- Right Column: Facts -->
      <div style="position:absolute;right:0;top:0;width:33%;">
        <div style="font-family:'JetBrains Mono',monospace;font-size:0.7rem;text-transform:uppercase;letter-spacing:2px;color:var(--accent-orange);margin-bottom:0.75rem;text-align:center;">Fact Tables</div>

        <div id="cd-fct-sales" style="background:var(--accent-orange-dim);border:1px solid rgba(249,115,22,0.3);border-radius:10px;padding:0.85rem;margin-bottom:0.75rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-orange);margin-bottom:0.35rem;">üí∞ fct_sales</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">‚Üí date_key ¬∑ ‚Üí product_key<br>‚Üí customer_key ¬∑ ‚Üí store_key<br>revenue ¬∑ quantity ¬∑ discount</div>
        </div>

        <div id="cd-fct-inventory" style="background:var(--accent-teal-dim);border:1px solid rgba(20,184,166,0.3);border-radius:10px;padding:0.85rem;margin-bottom:0.75rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-teal);margin-bottom:0.35rem;">üìä fct_inventory</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">‚Üí date_key ¬∑ ‚Üí product_key<br>‚Üí store_key<br>qty_on_hand ¬∑ reorder_point</div>
        </div>

        <div id="cd-fct-marketing" style="background:var(--accent-purple-dim);border:1px solid rgba(167,139,250,0.3);border-radius:10px;padding:0.85rem;">
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.82rem;font-weight:600;color:var(--accent-purple);margin-bottom:0.35rem;">üì£ fct_marketing</div>
          <div style="font-size:0.75rem;color:var(--text-muted);line-height:1.5;">‚Üí date_key ¬∑ ‚Üí product_key<br>‚Üí customer_key<br>impressions ¬∑ clicks ¬∑ spend</div>
        </div>
      </div>

      <!-- Center Legend -->
      <div style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);text-align:center;z-index:2;">
        <div style="width:90px;height:90px;border-radius:50%;border:1.5px dashed rgba(240,197,91,0.3);display:flex;align-items:center;justify-content:center;flex-direction:column;background:radial-gradient(circle,rgba(240,197,91,0.06) 0%,transparent 70%);margin:0 auto 0.5rem;">
          <div style="font-size:1.5rem;">üîó</div>
          <div style="font-family:'JetBrains Mono',monospace;font-size:0.55rem;letter-spacing:1px;text-transform:uppercase;color:var(--accent-gold);opacity:0.8;">Conformed</div>
        </div>
        <div style="font-size:0.65rem;color:var(--text-muted);max-width:100px;line-height:1.4;">Same keys, same meaning, across all facts</div>
      </div>

    </div>

    <!-- Connection Legend -->
    <div style="display:flex;justify-content:center;gap:1.5rem;margin-top:1rem;flex-wrap:wrap;">
      <div style="display:flex;align-items:center;gap:0.4rem;font-size:0.75rem;font-family:'JetBrains Mono',monospace;">
        <svg width="30" height="8"><line x1="0" y1="4" x2="30" y2="4" stroke="#f97316" stroke-width="1.5" stroke-dasharray="4 3"/></svg>
        <span style="color:var(--accent-orange);">Sales</span>
      </div>
      <div style="display:flex;align-items:center;gap:0.4rem;font-size:0.75rem;font-family:'JetBrains Mono',monospace;">
        <svg width="30" height="8"><line x1="0" y1="4" x2="30" y2="4" stroke="#14b8a6" stroke-width="1.5" stroke-dasharray="4 3"/></svg>
        <span style="color:var(--accent-teal);">Inventory</span>
      </div>
      <div style="display:flex;align-items:center;gap:0.4rem;font-size:0.75rem;font-family:'JetBrains Mono',monospace;">
        <svg width="30" height="8"><line x1="0" y1="4" x2="30" y2="4" stroke="#a78bfa" stroke-width="1.5" stroke-dasharray="4 3"/></svg>
        <span style="color:var(--accent-purple);">Marketing</span>
      </div>
      <div style="display:flex;align-items:center;gap:0.4rem;font-size:0.75rem;color:var(--text-muted);">
        <span style="font-style:italic;">dim_customer ‚Üí no inventory link; dim_store ‚Üí no marketing link</span>
      </div>
    </div>
  </div>

  <!-- Three key principles -->
  <div class="grid-3" style="margin-top:2rem;">
    <div class="card blue">
      <div class="card-icon" style="background:var(--accent-blue-dim);color:var(--accent-blue);">üéØ</div>
      <h3>Single Source of Truth</h3>
      <p>Each dimension is defined <strong>once</strong> and reused across all fact tables ‚Äî no duplicated definitions, no conflicting hierarchies, no "which dim_customer is right?" debates.</p>
    </div>
    <div class="card teal">
      <div class="card-icon" style="background:var(--accent-teal-dim);color:var(--accent-teal);">üîÄ</div>
      <h3>Cross-Process Drill Across</h3>
      <p>Because the keys conform, you can compare <strong>marketing spend vs. sales revenue</strong> for the same product in the same time period ‚Äî the holy grail of enterprise analytics.</p>
    </div>
    <div class="card purple">
      <div class="card-icon" style="background:var(--accent-purple-dim);color:var(--accent-purple);">üß©</div>
      <h3>Selective Participation</h3>
      <p>Not every dimension joins every fact. Customer doesn't link to Inventory; Store doesn't link to Marketing. <strong>Conformed ‚â† universal</strong> ‚Äî it means consistent where used.</p>
    </div>
  </div>

  <!-- Cross-fact SQL Example -->
  <div class="code-block" style="margin-top:2rem;">
    <div class="code-label">SQL ‚Äî Drill Across</div>
<pre>
<span class="cm">-- Compare sales revenue vs marketing spend by product and quarter</span>
<span class="cm">-- This query works ONLY because dim_date and dim_product are conformed</span>

<span class="kw">SELECT</span>
    d.quarter,
    p.category,
    <span class="fn">SUM</span>(s.revenue)   <span class="kw">AS</span> total_revenue,
    <span class="fn">SUM</span>(m.spend)     <span class="kw">AS</span> total_ad_spend,
    <span class="fn">ROUND</span>(<span class="fn">SUM</span>(s.revenue) / <span class="fn">NULLIF</span>(<span class="fn">SUM</span>(m.spend), <span class="num">0</span>), <span class="num">2</span>) <span class="kw">AS</span> roas
<span class="kw">FROM</span>      fct_sales     s
<span class="kw">JOIN</span>      dim_date      d  <span class="kw">ON</span> s.date_key    = d.date_key
<span class="kw">JOIN</span>      dim_product   p  <span class="kw">ON</span> s.product_key = p.product_key
<span class="kw">JOIN</span>      fct_marketing m  <span class="kw">ON</span> s.date_key    = m.date_key
                          <span class="kw">AND</span> s.product_key = m.product_key
<span class="kw">GROUP BY</span>  d.quarter, p.category
<span class="kw">ORDER BY</span>  d.quarter, roas <span class="kw">DESC</span>;
</pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROLE-PLAYING DIMENSIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="role-playing-dims">
  <div class="section-header">
    <div class="section-number">Section 12C</div>
    <h2 class="section-title">Role-Playing Dimensions</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">One physical table, many business roles ‚Äî how invoice date, order date, and ship date all live in dim_date</p>
  </div>

  <div class="card gold card-wide" style="margin-bottom:2rem;">
    <h3>What Are Role-Playing Dimensions?</h3>
    <p>A <strong>role-playing dimension</strong> is a single physical dimension table that is joined to the same fact table <em>multiple times</em>, each through a different foreign key representing a different <strong>business role</strong>. The dimension itself doesn't change ‚Äî only the FK in the fact table changes.</p>
    <p style="margin-top:1rem;">The most common example is <code>dim_date</code>: an orders fact table might have <code>order_date_key</code>, <code>invoice_date_key</code>, and <code>ship_date_key</code> ‚Äî all pointing to the same dim_date table.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî One Actor, Many Roles</div>
    <p>Think of <code>dim_date</code> as a versatile actor who appears in every scene of your business process, but wearing different costumes: once as "Order Date", once as "Invoice Date", once as "Ship Date". It's the same person (same table, same attributes) ‚Äî the role changes based on context.</p>
  </div>

  <!-- Visual: Fact table with multiple date FKs -->
  <div class="diagram-container">
    <div class="diagram-title">fact_orders ‚Äî Multiple Date Roles from One dim_date</div>
    <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:2rem;align-items:center;max-width:850px;margin:0 auto;">
      
      <!-- Left: Fact Table -->
      <div style="background:var(--accent-orange-dim);border:1px solid rgba(249,115,22,0.3);border-radius:12px;padding:1.5rem;">
        <div style="font-family:'JetBrains Mono',monospace;font-size:0.95rem;font-weight:600;color:var(--accent-orange);margin-bottom:1rem;text-align:center;">üìã fact_orders</div>
        <div style="display:flex;flex-direction:column;gap:0.6rem;">
          <div style="display:flex;align-items:center;gap:0.5rem;padding:0.5rem 0.75rem;background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.25);border-radius:6px;">
            <span style="font-size:0.7rem;color:var(--accent-blue);">‚Üí</span>
            <span style="font-family:'JetBrains Mono',monospace;font-size:0.8rem;color:var(--accent-blue);">order_date_key</span>
            <span style="margin-left:auto;font-size:0.65rem;color:var(--text-muted);">FK</span>
          </div>
          <div style="display:flex;align-items:center;gap:0.5rem;padding:0.5rem 0.75rem;background:rgba(20,184,166,0.1);border:1px solid rgba(20,184,166,0.25);border-radius:6px;">
            <span style="font-size:0.7rem;color:var(--accent-teal);">‚Üí</span>
            <span style="font-family:'JetBrains Mono',monospace;font-size:0.8rem;color:var(--accent-teal);">invoice_date_key</span>
            <span style="margin-left:auto;font-size:0.65rem;color:var(--text-muted);">FK</span>
          </div>
          <div style="display:flex;align-items:center;gap:0.5rem;padding:0.5rem 0.75rem;background:rgba(167,139,250,0.1);border:1px solid rgba(167,139,250,0.25);border-radius:6px;">
            <span style="font-size:0.7rem;color:var(--accent-purple);">‚Üí</span>
            <span style="font-family:'JetBrains Mono',monospace;font-size:0.8rem;color:var(--accent-purple);">ship_date_key</span>
            <span style="margin-left:auto;font-size:0.65rem;color:var(--text-muted);">FK</span>
          </div>
          <div style="display:flex;align-items:center;gap:0.5rem;padding:0.5rem 0.75rem;background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.25);border-radius:6px;">
            <span style="font-size:0.7rem;color:var(--accent-rose);">‚Üí</span>
            <span style="font-family:'JetBrains Mono',monospace;font-size:0.8rem;color:var(--accent-rose);">payment_date_key</span>
            <span style="margin-left:auto;font-size:0.65rem;color:var(--text-muted);">FK</span>
          </div>
          <div style="border-top:1px dashed rgba(148,163,184,0.15);padding-top:0.5rem;margin-top:0.25rem;">
            <div style="font-size:0.78rem;color:var(--text-muted);line-height:1.6;">‚Üí product_key ¬∑ ‚Üí customer_key<br>revenue ¬∑ quantity ¬∑ discount</div>
          </div>
        </div>
      </div>

      <!-- Center: Arrows -->
      <div style="display:flex;flex-direction:column;align-items:center;gap:0.4rem;">
        <div style="font-size:0.75rem;color:var(--accent-blue);">‚Üê Order</div>
        <div style="font-size:0.75rem;color:var(--accent-teal);">‚Üê Invoice</div>
        <div style="font-size:0.75rem;color:var(--accent-purple);">‚Üê Ship</div>
        <div style="font-size:0.75rem;color:var(--accent-rose);">‚Üê Payment</div>
        <div style="margin-top:0.5rem;font-size:0.65rem;color:var(--text-muted);text-align:center;">All point to<br>the same table</div>
      </div>

      <!-- Right: dim_date -->
      <div style="background:var(--accent-gold-dim);border:2px solid rgba(240,197,91,0.4);border-radius:12px;padding:1.5rem;box-shadow:0 0 30px rgba(240,197,91,0.08);">
        <div style="font-family:'JetBrains Mono',monospace;font-size:0.95rem;font-weight:600;color:var(--accent-gold);margin-bottom:1rem;text-align:center;">üìÖ dim_date</div>
        <div style="font-size:0.78rem;color:var(--text-muted);line-height:1.8;">
          üîë <strong style="color:var(--accent-gold);">date_key</strong><br>
          full_date<br>
          day_of_week<br>
          month ¬∑ quarter<br>
          fiscal_year<br>
          is_holiday<br>
          is_weekend
        </div>
        <div style="margin-top:0.75rem;padding-top:0.75rem;border-top:1px solid rgba(240,197,91,0.2);font-size:0.72rem;color:var(--accent-gold);text-align:center;font-weight:600;">Built once. Maintained once.<br>Reused in every role.</div>
      </div>
    </div>
  </div>

  <!-- SQL Example -->
  <div class="code-block" style="margin-top:2rem;">
    <div class="code-label">SQL ‚Äî Role-Playing Joins</div>
<pre>
<span class="cm">-- Each alias joins to the SAME dim_date, but via a different FK</span>

<span class="kw">SELECT</span>
    od.full_date    <span class="kw">AS</span> order_date,
    id.full_date    <span class="kw">AS</span> invoice_date,
    sd.full_date    <span class="kw">AS</span> ship_date,
    pd.full_date    <span class="kw">AS</span> payment_date,
    <span class="fn">DATEDIFF</span>(sd.full_date, od.full_date) <span class="kw">AS</span> days_to_ship,
    <span class="fn">DATEDIFF</span>(pd.full_date, id.full_date) <span class="kw">AS</span> days_to_pay,
    p.product_name,
    f.revenue
<span class="kw">FROM</span> fact_orders f
<span class="kw">JOIN</span> dim_date    od <span class="kw">ON</span> f.order_date_key   = od.date_key   <span class="cm">-- role: Order Date</span>
<span class="kw">JOIN</span> dim_date    id <span class="kw">ON</span> f.invoice_date_key = id.date_key   <span class="cm">-- role: Invoice Date</span>
<span class="kw">JOIN</span> dim_date    sd <span class="kw">ON</span> f.ship_date_key    = sd.date_key   <span class="cm">-- role: Ship Date</span>
<span class="kw">JOIN</span> dim_date    pd <span class="kw">ON</span> f.payment_date_key = pd.date_key   <span class="cm">-- role: Payment Date</span>
<span class="kw">JOIN</span> dim_product  p <span class="kw">ON</span> f.product_key      = p.product_key;
</pre>
  </div>

  <!-- Key Principles -->
  <div class="grid-2" style="margin-top:2rem;">
    <div class="card blue card-wide">
      <h3>üèóÔ∏è Physical vs. Logical</h3>
      <p><strong>Physically:</strong> There is only ONE <code>dim_date</code> table in the database.</p>
      <p style="margin-top:0.5rem;"><strong>Logically:</strong> Each foreign key creates a "virtual" dimension. BI tools like Power BI, Looker, and Tableau let you create named views or aliases ‚Äî so end users see "Order Date" and "Ship Date" as separate dimensions in the UI.</p>
    </div>
    <div class="card gold card-wide">
      <h3>üö´ Anti-Pattern: Cloning Tables</h3>
      <p>The wrong approach is creating <code>dim_order_date</code>, <code>dim_ship_date</code>, and <code>dim_invoice_date</code> as separate physical tables with identical schemas. This violates DRY, triples maintenance, and guarantees they'll drift out of sync.</p>
      <p style="margin-top:0.5rem;"><strong>Rule:</strong> One physical table + multiple aliases = role-playing done right.</p>
    </div>
  </div>

  <!-- Common role-playing dimensions beyond date -->
  <div class="card teal card-wide" style="margin-top:1.5rem;">
    <h3>üìã Common Role-Playing Dimensions Beyond Date</h3>
    <table class="styled-table">
      <thead><tr><th>Dimension</th><th>Example Roles in Fact Table</th><th>FK Names</th></tr></thead>
      <tbody>
        <tr><td><code>dim_date</code></td><td>Order date, Invoice date, Ship date, Payment date</td><td><code>order_date_key</code>, <code>invoice_date_key</code>, <code>ship_date_key</code></td></tr>
        <tr><td><code>dim_employee</code></td><td>Salesperson, Approving manager, Assigned technician</td><td><code>salesperson_key</code>, <code>manager_key</code>, <code>technician_key</code></td></tr>
        <tr><td><code>dim_location</code></td><td>Origin warehouse, Destination store, Billing address</td><td><code>origin_key</code>, <code>destination_key</code>, <code>billing_location_key</code></td></tr>
        <tr><td><code>dim_account</code></td><td>Source account, Target account (in transfers)</td><td><code>source_account_key</code>, <code>target_account_key</code></td></tr>
      </tbody>
    </table>
  </div>

  <div class="exercise-box" style="margin-top:2rem;">
    <div class="exercise-title">Exercise ‚Äî Spot the Roles</div>
    <div class="exercise-difficulty" style="color:var(--accent-teal);">‚ö° Intermediate</div>
    <p>Your company's <code>fact_shipments</code> table needs to track: <strong>origin warehouse</strong>, <strong>destination store</strong>, and <strong>return facility</strong>. All three are locations with the same attributes (name, city, region, country).</p>
    <p style="margin-top:0.75rem;"><strong>Task:</strong> (1) Should you create three separate dim tables or one role-playing dim? (2) Write the FK columns for fact_shipments. (3) Write a SQL query that calculates average shipping distance between origin and destination cities.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî SIMPLE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="simple">
  <div class="section-header">
    <div class="section-number">Section 13</div>
    <h2 class="section-title">Simple ‚Äî Coffee Shop Sales</h2>
    <div class="section-divider"></div>
    <div class="level-badge level-simple" style="display:inline-flex;margin:0 auto;">‚òï Beginner</div>
  </div>
  <div class="card gold card-wide"><h3>Scenario</h3><p>Single coffee shop. Questions: <em>What drinks sell best? Peak hours? Which baristas generate most revenue?</em></p></div>
  <div class="code-block" style="margin-top:1.5rem;">
    <div class="code-label">SQL DDL</div>
<pre>
<span class="kw">CREATE TABLE</span> <span class="fn">dim_date</span> (
    <span class="type">date_key</span>      <span class="kw">INT PRIMARY KEY</span>,  <span class="cm">-- YYYYMMDD</span>
    <span class="type">full_date</span>     <span class="kw">DATE</span>,    <span class="type">day_of_week</span>   <span class="kw">VARCHAR(10)</span>,
    <span class="type">month_name</span>    <span class="kw">VARCHAR(10)</span>,    <span class="type">quarter</span>  <span class="kw">INT</span>,    <span class="type">year</span>  <span class="kw">INT</span>,    <span class="type">is_weekend</span>  <span class="kw">BOOLEAN</span>
);

<span class="kw">CREATE TABLE</span> <span class="fn">dim_drink</span> (
    <span class="type">drink_key</span>     <span class="kw">INT PRIMARY KEY</span>,
    <span class="type">drink_name</span>    <span class="kw">VARCHAR(100)</span>,   <span class="type">category</span>  <span class="kw">VARCHAR(50)</span>,
    <span class="type">size</span>          <span class="kw">VARCHAR(10)</span>,    <span class="type">is_seasonal</span>  <span class="kw">BOOLEAN</span>
);

<span class="kw">CREATE TABLE</span> <span class="fn">dim_barista</span> (
    <span class="type">barista_key</span>   <span class="kw">INT PRIMARY KEY</span>,
    <span class="type">barista_name</span>  <span class="kw">VARCHAR(100)</span>,   <span class="type">hire_date</span>  <span class="kw">DATE</span>,   <span class="type">shift</span>  <span class="kw">VARCHAR(10)</span>
);

<span class="kw">CREATE TABLE</span> <span class="fn">fact_coffee_sales</span> (
    <span class="type">sale_key</span>         <span class="kw">INT PRIMARY KEY</span>,
    <span class="type">date_key</span>         <span class="kw">INT REFERENCES</span> dim_date,
    <span class="type">drink_key</span>        <span class="kw">INT REFERENCES</span> dim_drink,
    <span class="type">barista_key</span>      <span class="kw">INT REFERENCES</span> dim_barista,
    <span class="type">transaction_id</span>   <span class="kw">VARCHAR(20)</span>,       <span class="cm">-- degenerate dimension</span>
    <span class="type">quantity</span>         <span class="kw">INT</span>,
    <span class="type">unit_price</span>       <span class="kw">DECIMAL(6,2)</span>,
    <span class="type">total_price</span>      <span class="kw">DECIMAL(8,2)</span>
);
</pre>
  </div>
  <div class="callout callout-tip"><h4>Why This Works</h4><p>Three dimensions, three joins, dead simple. "Show me what sold, when, and who made it." Star schemas read like English.</p></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî MEDIUM ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="medium">
  <div class="section-header">
    <div class="section-number">Section 14</div>
    <h2 class="section-title">Medium ‚Äî SaaS Subscription Platform</h2>
    <div class="section-divider"></div>
    <div class="level-badge level-medium" style="display:inline-flex;margin:0 auto;">üíª Intermediate</div>
  </div>
  <div class="card blue card-wide"><h3>Scenario</h3><p>B2B SaaS product. Track MRR by plan, churn by segment, feature usage, support volume. <strong>Two fact tables</strong> sharing conformed dimensions ‚Äî your first "data mart bus."</p></div>
  <div class="grid-2" style="margin-top:1.5rem;">
    <div class="card teal"><h3>Fact 1: Subscription Snapshots</h3><p><strong>Periodic snapshot</strong> ‚Äî one row per customer per month. Measures: mrr_amount (semi-additive!), seats_purchased, seats_active, is_churned.</p></div>
    <div class="card purple"><h3>Fact 2: Support Tickets</h3><p><strong>Transaction + accumulating snapshot</strong> ‚Äî one row per ticket with milestone dates. Measures: priority_score, resolution_minutes. Multiple date roles: created, assigned, resolved.</p></div>
  </div>
  <div class="callout callout-key" style="margin-top:1.5rem;">
    <h4>Conformed Dimension Spotlight</h4>
    <p><code>dim_customer</code> and <code>dim_date</code> are <strong>shared across both fact tables</strong>. This is the <strong>Bus Architecture</strong> ‚Äî analysts can join subscription data with support data because dimensions are identical.</p>
  </div>
  <div class="callout callout-warning">
    <h4>Semi-Additive Trap</h4>
    <p>MRR is <strong>semi-additive</strong>: sum across customers ‚úÖ, but <strong>not across time</strong> ‚ùå (Jan MRR + Feb MRR = double-counting). Use <code>AVG()</code>, <code>MAX()</code>, or pick a snapshot date.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî ADVANCED ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="advanced">
  <div class="section-header">
    <div class="section-number">Section 15</div>
    <h2 class="section-title">Advanced ‚Äî Multi-Channel Retailer</h2>
    <div class="section-divider"></div>
    <div class="level-badge level-advanced" style="display:inline-flex;margin:0 auto;">üè¨ Advanced</div>
  </div>
  <div class="card purple card-wide"><h3>Scenario</h3><p>Fashion retailer: <strong>physical stores + e-commerce + mobile app</strong>. This introduces <strong>role-playing dimensions, junk dimensions, bridge tables, and heterogeneous products</strong>.</p></div>
  <div class="grid-2" style="margin-top:1.5rem;">
    <div class="card gold"><h3>Role-Playing Dimensions</h3><p>Same <code>dim_date</code> used as order_date, ship_date, delivery_date ‚Äî three roles, one physical table, different SQL aliases.</p>
      <div class="code-block"><pre><span class="kw">JOIN</span> dim_date <span class="fn">order_dt</span> <span class="kw">ON</span> f.order_date_key = order_dt.date_key
<span class="kw">JOIN</span> dim_date <span class="fn">ship_dt</span>  <span class="kw">ON</span> f.ship_date_key  = ship_dt.date_key
<span class="kw">JOIN</span> dim_date <span class="fn">dlvr_dt</span>  <span class="kw">ON</span> f.delivery_date_key = dlvr_dt.date_key</pre></div>
    </div>
    <div class="card teal"><h3>Junk Dimensions</h3><p>Grab-bag dimension for low-cardinality flags: is_gift_wrap, is_expedited, payment_type, order_channel. Only ~200 combinations ‚Üí tiny table replacing 4+ fact columns with 1 FK.</p></div>
    <div class="card blue"><h3>Bridge Tables</h3><p>For many-to-many: an order with multiple promotions. Bridge table with weighting factors (summing to 1.0) prevents double-counting.</p></div>
    <div class="card rose"><h3>Heterogeneous Products</h3><p>Clothing, electronics, groceries ‚Äî each with unique attributes. Core <code>dim_product</code> + product-type outrigger tables for specialized attributes.</p></div>
  </div>
  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Swiss Army Knife</div>
    <p><strong>Role-playing</strong> = Same blade used as knife, screwdriver, can opener. <strong>Junk dims</strong> = Kitchen junk drawer (batteries, rubber bands, twist ties). <strong>Bridge tables</strong> = Instagram group photo tags ‚Äî one photo tags multiple people, one person in multiple photos.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî COMPLEX ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="complex">
  <div class="section-header">
    <div class="section-number">Section 16</div>
    <h2 class="section-title">Complex ‚Äî Healthcare Claims Warehouse</h2>
    <div class="section-divider"></div>
    <div class="level-badge level-complex" style="display:inline-flex;margin:0 auto;">üè• Expert</div>
  </div>
  <div class="card rose card-wide"><h3>Scenario</h3><p>Health insurer processing <strong>millions of claims</strong>/year. Complex lifecycle (submitted ‚Üí adjudicated ‚Üí paid/denied ‚Üí appealed), multiple diagnosis codes, multiple procedure codes. Uses <strong>every advanced Kimball pattern simultaneously</strong>.</p></div>
  <div class="code-block" style="margin-top:1.5rem;">
    <div class="code-label">Complex Fact Table</div>
<pre>
<span class="kw">CREATE TABLE</span> <span class="fn">fact_claim_lifecycle</span> (
    <span class="type">claim_key</span>               <span class="kw">INT PRIMARY KEY</span>,
    <span class="cm">-- 6 role-playing date dimensions</span>
    <span class="type">submitted_date_key</span>      <span class="kw">INT</span>,   <span class="type">received_date_key</span>     <span class="kw">INT</span>,
    <span class="type">adjudicated_date_key</span>    <span class="kw">INT</span>,   <span class="type">paid_date_key</span>         <span class="kw">INT</span>,
    <span class="type">appeal_date_key</span>         <span class="kw">INT</span>,   <span class="type">closed_date_key</span>       <span class="kw">INT</span>,
    <span class="cm">-- Regular + mini + junk + bridge dimensions</span>
    <span class="type">patient_key</span>             <span class="kw">INT</span>,
    <span class="type">patient_profile_key</span>     <span class="kw">INT</span>,   <span class="cm">-- mini-dimension (volatile demographics)</span>
    <span class="type">provider_key</span>            <span class="kw">INT</span>,   <span class="type">facility_key</span>   <span class="kw">INT</span>,   <span class="type">payer_key</span>   <span class="kw">INT</span>,
    <span class="type">diagnosis_group_key</span>     <span class="kw">INT</span>,   <span class="cm">-- ‚Üí bridge table (multi-valued)</span>
    <span class="type">claim_flags_key</span>         <span class="kw">INT</span>,   <span class="cm">-- junk dimension</span>
    <span class="type">claim_number</span>            <span class="kw">VARCHAR(30)</span>, <span class="cm">-- degenerate dimension</span>
    <span class="cm">-- Measures</span>
    <span class="type">billed_amount</span>  <span class="kw">DECIMAL(12,2)</span>,  <span class="type">allowed_amount</span>  <span class="kw">DECIMAL(12,2)</span>,
    <span class="type">paid_amount</span>    <span class="kw">DECIMAL(12,2)</span>,  <span class="type">patient_responsibility</span>  <span class="kw">DECIMAL(12,2)</span>,
    <span class="cm">-- Lag measures (computed from milestones)</span>
    <span class="type">days_to_adjudicate</span>  <span class="kw">INT</span>,  <span class="type">days_to_pay</span>  <span class="kw">INT</span>,  <span class="type">days_to_close</span>  <span class="kw">INT</span>
);
</pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî E-COMMERCE CASE STUDY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="ecommerce">
  <div class="section-header">
    <div class="section-number">Section 17</div>
    <h2 class="section-title">Real-World ‚Äî E-Commerce Dimensional Model</h2>
    <div class="section-divider"></div>
    <div class="level-badge level-real" style="display:inline-flex;margin:0 auto;">üõí Production-Grade</div>
    <p class="section-subtitle" style="margin-top:1rem;">How an online health supplements company implements Kimball at scale.</p>
  </div>

  <div class="diagram-container" style="margin-top:2rem;">
    <div class="diagram-title">Enterprise Bus Matrix</div>
    <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:1.5rem;">Rows = business processes (fact tables). Columns = dimensions. ‚úÖ = shared/conformed.</p>
    <div style="overflow-x:auto;">
      <table class="styled-table" style="min-width:800px;">
        <thead><tr><th>Process ‚Üí</th><th>Date</th><th>Customer</th><th>Product</th><th>Channel</th><th>Geo</th><th>Promo</th><th>Warehouse</th><th>Supplier</th></tr></thead>
        <tbody>
          <tr><td style="font-weight:600;color:var(--accent-gold);">Orders</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td></td></tr>
          <tr><td style="font-weight:600;color:var(--accent-gold);">Returns</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td></td><td>‚úÖ</td><td></td></tr>
          <tr><td style="font-weight:600;color:var(--accent-gold);">Inventory</td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td></td><td></td><td>‚úÖ</td><td>‚úÖ</td></tr>
          <tr><td style="font-weight:600;color:var(--accent-gold);">Clickstream</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td></td></tr>
          <tr><td style="font-weight:600;color:var(--accent-gold);">Shipments</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td><td>‚úÖ</td><td></td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:3rem 0 1.5rem;font-size:1.4rem;">Primary Star: Order Line Items</h4>
  <div class="code-block">
    <div class="code-label">Production Fact</div>
<pre>
<span class="kw">CREATE TABLE</span> <span class="fn">fact_order_line</span> (
    <span class="type">order_line_key</span>     <span class="kw">BIGINT PRIMARY KEY</span>,
    <span class="cm">-- Role-playing dates</span>
    <span class="type">order_date_key</span>     <span class="kw">INT</span>,  <span class="type">ship_date_key</span>  <span class="kw">INT</span>,  <span class="type">delivery_date_key</span>  <span class="kw">INT</span>,
    <span class="cm">-- Conformed dimensions</span>
    <span class="type">customer_key</span>       <span class="kw">INT</span>,  <span class="type">product_key</span>  <span class="kw">INT</span>,  <span class="type">channel_key</span>  <span class="kw">INT</span>,
    <span class="type">ship_to_geo_key</span>    <span class="kw">INT</span>,  <span class="type">promo_key</span>  <span class="kw">INT</span>,  <span class="type">warehouse_key</span>  <span class="kw">INT</span>,
    <span class="type">order_flags_key</span>    <span class="kw">INT</span>,       <span class="cm">-- junk dimension</span>
    <span class="type">order_number</span>       <span class="kw">VARCHAR(30)</span>,  <span class="cm">-- degenerate dim</span>
    <span class="type">line_number</span>        <span class="kw">INT</span>,           <span class="cm">-- degenerate dim</span>
    <span class="cm">-- Additive measures</span>
    <span class="type">quantity_ordered</span>   <span class="kw">INT</span>,        <span class="type">unit_price</span>  <span class="kw">DECIMAL(10,2)</span>,
    <span class="type">unit_cost</span>          <span class="kw">DECIMAL(10,2)</span>,  <span class="type">extended_price</span>  <span class="kw">DECIMAL(12,2)</span>,
    <span class="type">discount_amount</span>    <span class="kw">DECIMAL(10,2)</span>,  <span class="type">tax_amount</span>  <span class="kw">DECIMAL(10,2)</span>,
    <span class="type">shipping_cost</span>      <span class="kw">DECIMAL(10,2)</span>,  <span class="type">net_revenue</span>  <span class="kw">DECIMAL(12,2)</span>,
    <span class="type">gross_margin</span>       <span class="kw">DECIMAL(12,2)</span>,
    <span class="cm">-- Non-additive (compute at query time when possible)</span>
    <span class="type">margin_pct</span>  <span class="kw">DECIMAL(5,4)</span>,  <span class="type">discount_pct</span>  <span class="kw">DECIMAL(5,4)</span>
);
</pre>
  </div>

  <div class="code-block">
    <div class="code-label">Real Business Query ‚Äî Cohort Revenue</div>
<pre>
<span class="kw">SELECT</span>
    <span class="fn">DATE_TRUNC</span>(<span class="str">'month'</span>, c.registration_date) <span class="kw">AS</span> cohort_month,
    d.month_name || <span class="str">' '</span> || d.year              <span class="kw">AS</span> order_month,
    <span class="fn">COUNT</span>(<span class="kw">DISTINCT</span> c.customer_id)              <span class="kw">AS</span> active_customers,
    <span class="fn">SUM</span>(f.net_revenue)                        <span class="kw">AS</span> total_revenue
<span class="kw">FROM</span> fact_order_line f
<span class="kw">JOIN</span> dim_customer c  <span class="kw">ON</span> f.customer_key = c.customer_key <span class="kw">AND</span> c.is_current
<span class="kw">JOIN</span> dim_date d      <span class="kw">ON</span> f.order_date_key = d.date_key
<span class="kw">GROUP BY</span> <span class="num">1</span>, <span class="num">2</span>
<span class="kw">ORDER BY</span> cohort_month, order_month;
</pre>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Department Store Floor Plan</div>
    <p>Each star schema is a <strong>department</strong>. Orders department, Returns department, Inventory department. But all use the <strong>same customer loyalty system</strong> (dim_customer), <strong>same product catalog</strong> (dim_product), <strong>same calendar</strong> (dim_date). A customer who buys shoes in one and returns a shirt in another is recognized everywhere. That's conformed dimensions connecting multiple stars into an enterprise warehouse.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî dbt IMPLEMENTATION (NEW) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="dbt-impl">
  <div class="section-header">
    <div class="section-number">Section 18</div>
    <h2 class="section-title">Implementing Kimball with dbt</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Kimball as code ‚Äî the modern way to build dimensional models. Copy these patterns directly into your dbt project.</p>
  </div>

  <div class="card gold card-wide">
    <h3>dbt Project Structure = Kimball Layers</h3>
    <div class="code-block">
      <div class="code-label">Project Layout</div>
<pre>
models/
‚îú‚îÄ‚îÄ staging/              <span class="cm">‚Üê 1:1 with source tables (clean + rename)</span>
‚îÇ   ‚îú‚îÄ‚îÄ stg_shopify__orders.sql
‚îÇ   ‚îú‚îÄ‚îÄ stg_shopify__order_lines.sql
‚îÇ   ‚îú‚îÄ‚îÄ stg_shopify__customers.sql
‚îÇ   ‚îî‚îÄ‚îÄ stg_shopify__products.sql
‚îú‚îÄ‚îÄ intermediate/         <span class="cm">‚Üê Business logic, joins, dedup, SCD logic</span>
‚îÇ   ‚îú‚îÄ‚îÄ int_orders__enriched.sql
‚îÇ   ‚îî‚îÄ‚îÄ int_customers__deduplicated.sql
‚îî‚îÄ‚îÄ marts/                <span class="cm">‚Üê ‚≠ê KIMBALL STAR SCHEMAS ‚≠ê</span>
    ‚îú‚îÄ‚îÄ core/
    ‚îÇ   ‚îú‚îÄ‚îÄ dim_date.sql
    ‚îÇ   ‚îú‚îÄ‚îÄ dim_customer.sql
    ‚îÇ   ‚îú‚îÄ‚îÄ dim_product.sql
    ‚îÇ   ‚îú‚îÄ‚îÄ dim_channel.sql
    ‚îÇ   ‚îî‚îÄ‚îÄ fct_order_lines.sql
    ‚îî‚îÄ‚îÄ marketing/
        ‚îî‚îÄ‚îÄ fct_campaign_performance.sql
</pre>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2rem 0 1rem;font-size:1.2rem;">Real dbt Models ‚Äî Copy-Pasteable</h4>

  <div class="grid-2">
    <div class="card blue card-wide">
      <h3>Staging Model</h3>
      <div class="code-block">
        <div class="code-label">stg_shopify__orders.sql</div>
<pre>
<span class="kw">WITH</span> source <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">source</span>(<span class="str">'shopify'</span>, <span class="str">'orders'</span>) }}
),

renamed <span class="kw">AS</span> (
    <span class="kw">SELECT</span>
        id                <span class="kw">AS</span> order_id,
        customer_id,
        order_number,
        created_at        <span class="kw">AS</span> ordered_at,
        total_price       <span class="kw">AS</span> order_total,
        financial_status  <span class="kw">AS</span> payment_status,
        fulfillment_status,
        cancel_reason,
        source_name       <span class="kw">AS</span> order_channel,
        _fivetran_synced  <span class="kw">AS</span> loaded_at
    <span class="kw">FROM</span> source
    <span class="kw">WHERE</span> _fivetran_deleted <span class="kw">IS FALSE</span>
)

<span class="kw">SELECT</span> * <span class="kw">FROM</span> renamed
</pre>
      </div>
    </div>

    <div class="card teal card-wide">
      <h3>Dimension Model</h3>
      <div class="code-block">
        <div class="code-label">dim_customer.sql</div>
<pre>
<span class="kw">WITH</span> customers <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">ref</span>(<span class="str">'stg_shopify__customers'</span>) }}
),

enriched <span class="kw">AS</span> (
    <span class="kw">SELECT</span>
        <span class="cm">-- Surrogate key</span>
        {{ <span class="fn">dbt_utils.generate_surrogate_key</span>(
            [<span class="str">'customer_id'</span>]
        ) }} <span class="kw">AS</span> customer_key,

        <span class="cm">-- Natural key</span>
        customer_id,

        <span class="cm">-- Attributes</span>
        first_name,
        last_name,
        first_name || <span class="str">' '</span> || last_name
            <span class="kw">AS</span> full_name,
        email,
        city,
        state,
        country,
        created_at   <span class="kw">AS</span> registration_date,

        <span class="cm">-- Computed attributes</span>
        <span class="kw">CASE</span>
          <span class="kw">WHEN</span> total_spent >= <span class="num">500</span>
            <span class="kw">THEN</span> <span class="str">'Gold'</span>
          <span class="kw">WHEN</span> total_spent >= <span class="num">200</span>
            <span class="kw">THEN</span> <span class="str">'Silver'</span>
          <span class="kw">ELSE</span> <span class="str">'Bronze'</span>
        <span class="kw">END AS</span> loyalty_tier,

        <span class="cm">-- SCD Type 2 metadata</span>
        <span class="kw">TRUE AS</span> is_current,
        created_at <span class="kw">AS</span> effective_start,
        <span class="str">'9999-12-31'</span>::<span class="kw">DATE AS</span> effective_end
    <span class="kw">FROM</span> customers
)

<span class="kw">SELECT</span> * <span class="kw">FROM</span> enriched
</pre>
      </div>
    </div>
  </div>

  <div class="card gold card-wide" style="margin-top:1.5rem;">
    <h3>Fact Model</h3>
    <div class="code-block">
      <div class="code-label">fct_order_lines.sql</div>
<pre>
<span class="kw">WITH</span> order_lines <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">ref</span>(<span class="str">'stg_shopify__order_lines'</span>) }}
),

orders <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">ref</span>(<span class="str">'stg_shopify__orders'</span>) }}
),

dim_date <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">ref</span>(<span class="str">'dim_date'</span>) }}
),

dim_customer <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">ref</span>(<span class="str">'dim_customer'</span>) }}
),

dim_product <span class="kw">AS</span> (
    <span class="kw">SELECT</span> * <span class="kw">FROM</span> {{ <span class="fn">ref</span>(<span class="str">'dim_product'</span>) }}
),

final <span class="kw">AS</span> (
    <span class="kw">SELECT</span>
        <span class="cm">-- Surrogate key for the fact row</span>
        {{ <span class="fn">dbt_utils.generate_surrogate_key</span>(
            [<span class="str">'ol.order_id'</span>, <span class="str">'ol.line_number'</span>]
        ) }}                                   <span class="kw">AS</span> order_line_key,

        <span class="cm">-- Dimension FKs (look up surrogate keys)</span>
        dd.date_key                            <span class="kw">AS</span> order_date_key,
        dc.customer_key,
        dp.product_key,

        <span class="cm">-- Degenerate dimensions</span>
        o.order_number,
        ol.line_number,

        <span class="cm">-- Measures</span>
        ol.quantity,
        ol.unit_price,
        ol.quantity * ol.unit_price            <span class="kw">AS</span> extended_price,
        <span class="fn">COALESCE</span>(ol.discount_amount, <span class="num">0</span>)        <span class="kw">AS</span> discount_amount,
        (ol.quantity * ol.unit_price)
          - <span class="fn">COALESCE</span>(ol.discount_amount, <span class="num">0</span>)    <span class="kw">AS</span> net_revenue

    <span class="kw">FROM</span> order_lines ol
    <span class="kw">JOIN</span> orders o        <span class="kw">ON</span> ol.order_id = o.order_id
    <span class="kw">LEFT JOIN</span> dim_date dd     <span class="kw">ON</span> o.ordered_at::DATE = dd.full_date
    <span class="kw">LEFT JOIN</span> dim_customer dc  <span class="kw">ON</span> o.customer_id = dc.customer_id
                              <span class="kw">AND</span> dc.is_current
    <span class="kw">LEFT JOIN</span> dim_product dp   <span class="kw">ON</span> ol.product_id = dp.product_id
                              <span class="kw">AND</span> dp.is_current
)

<span class="kw">SELECT</span> * <span class="kw">FROM</span> final
</pre>
    </div>
  </div>

  <div class="callout callout-tip">
    <h4>dbt schema.yml ‚Äî Tests That Enforce Kimball Rules</h4>
    <div class="code-block">
<pre>
<span class="cm">models:</span>
  <span class="cm">- name:</span> fct_order_lines
    <span class="cm">columns:</span>
      <span class="cm">- name:</span> order_line_key
        <span class="cm">tests:</span>
          - unique          <span class="cm"># every fact row is unique</span>
          - not_null
      <span class="cm">- name:</span> order_date_key
        <span class="cm">tests:</span>
          - not_null
          - relationships:  <span class="cm"># referential integrity!</span>
              to: ref('dim_date')
              field: date_key
      <span class="cm">- name:</span> customer_key
        <span class="cm">tests:</span>
          - not_null
          - relationships:
              to: ref('dim_customer')
              field: customer_key
      <span class="cm">- name:</span> net_revenue
        <span class="cm">tests:</span>
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0    <span class="cm"># revenue shouldn't be negative</span>
</pre>
    </div>
  </div>
</section>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEW ‚Äî ETL/ELT LOADING PATTERNS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="etl-patterns">
  <div class="section-header">
    <div class="section-number">Section 19</div>
    <h2 class="section-title">ETL/ELT Loading Patterns</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">How data actually gets into your star schemas ‚Äî extraction, loading strategies, and handling edge cases.</p>
  </div>

  <div class="grid-2">
    <div class="card gold card-wide">
      <h3 style="color:var(--accent-gold);">Traditional ETL</h3>
      <p><strong>Extract ‚Üí Transform ‚Üí Load</strong></p>
      <ul class="clean-list">
        <li>Data is cleaned and modeled <em>before</em> entering the warehouse</li>
        <li>Transformation happens in a separate tool (Informatica, Talend, SSIS)</li>
        <li>Warehouse stores only curated, analysis-ready data</li>
        <li><strong>Pros:</strong> Clean warehouse, lower storage costs</li>
        <li><strong>Cons:</strong> Slow iteration, hard to reprocess, vendor lock-in</li>
      </ul>
    </div>
    <div class="card teal card-wide">
      <h3 style="color:var(--accent-teal);">Modern ELT ‚≠ê</h3>
      <p><strong>Extract ‚Üí Load ‚Üí Transform</strong></p>
      <ul class="clean-list">
        <li>Raw data lands in the warehouse first, then transformed in-place</li>
        <li>Transformation in SQL/dbt using the warehouse's compute power</li>
        <li>Raw layer preserved for reprocessing and auditing</li>
        <li><strong>Pros:</strong> Fast iteration, full history, dbt-native, cheaper compute</li>
        <li><strong>Cons:</strong> Higher storage (raw + transformed), needs governance</li>
      </ul>
    </div>
  </div>

  <div class="callout callout-key" style="margin-top:2rem;">
    <h4>üîë Modern Standard: ELT with dbt</h4>
    <p>The modern data stack uses ELT: <strong>Fivetran/Airbyte</strong> (Extract + Load raw data) ‚Üí <strong>dbt</strong> (Transform in-warehouse) ‚Üí <strong>Looker/Tableau</strong> (Consume). This is the dominant pattern for Kimball modeling today. All the dbt code in this presentation assumes ELT.</p>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Dimension Loading Strategies</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Strategy</th><th>How It Works</th><th>When to Use</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Full Refresh</strong></td>
          <td>Truncate + reload the entire dimension every run</td>
          <td>Small dims (&lt;100K rows), no SCD needed, source doesn't provide change flags</td>
        </tr>
        <tr>
          <td><strong>Incremental (SCD1)</strong></td>
          <td>MERGE/upsert: insert new rows, overwrite changed attributes</td>
          <td>Medium dims, history not needed, corrections only</td>
        </tr>
        <tr>
          <td><strong>SCD Type 2</strong></td>
          <td>Close current row (set end_date, is_current=false), insert new version</td>
          <td>When "as was" analysis matters: segment, address, tier, status</td>
        </tr>
        <tr>
          <td><strong>dbt Snapshots</strong></td>
          <td>dbt automatically detects changes and creates SCD2 rows</td>
          <td>Modern dbt projects ‚Äî handles SCD2 with minimal code</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Fact Loading Strategies</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Strategy</th><th>How It Works</th><th>When to Use</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Append-Only</strong></td>
          <td>Insert new rows only ‚Äî never update existing facts</td>
          <td>Transaction facts (sales, clicks, events) ‚Äî most common</td>
        </tr>
        <tr>
          <td><strong>Full Snapshot</strong></td>
          <td>Capture complete state at each interval (daily, weekly)</td>
          <td>Periodic snapshot facts (inventory levels, account balances)</td>
        </tr>
        <tr>
          <td><strong>Incremental + MERGE</strong></td>
          <td>Insert new rows + update existing rows when milestones are reached</td>
          <td>Accumulating snapshot facts (order lifecycle: placed ‚Üí shipped ‚Üí delivered)</td>
        </tr>
        <tr>
          <td><strong>dbt Incremental</strong></td>
          <td><code>{{ config(materialized='incremental') }}</code> ‚Äî dbt appends only new/changed rows</td>
          <td>Large fact tables where full refresh is too slow</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Handling Edge Cases</h4>
  <div class="grid-2">
    <div class="card rose card-wide">
      <h3 style="color:var(--accent-rose);">Late-Arriving Facts</h3>
      <p>A transaction arrives <em>after</em> the batch window (e.g., a sale on Jan 31 arrives on Feb 3).</p>
      <ul class="clean-list">
        <li><strong>Solution:</strong> Always use the event's business date, not the load date, as the date FK</li>
        <li>Incremental models should have a lookback window: <code>WHERE event_date >= current_date - 3</code></li>
        <li>Idempotent loads: re-running the same batch produces the same result</li>
      </ul>
    </div>
    <div class="card purple card-wide">
      <h3 style="color:var(--accent-purple);">Late-Arriving Dimensions</h3>
      <p>A fact row arrives referencing a dimension member that doesn't exist yet (e.g., new product sold before master data is synced).</p>
      <ul class="clean-list">
        <li><strong>Solution:</strong> Insert a placeholder row in the dimension (attributes = 'Unknown / Pending')</li>
        <li>When the real data arrives, update the placeholder row (SCD1) or add a new version (SCD2)</li>
        <li>The fact row's FK already points to the correct surrogate key ‚Äî no fact updates needed</li>
      </ul>
    </div>
  </div>

  <div class="grid-2" style="margin-top:1rem;">
    <div class="card gold card-wide">
      <h3 style="color:var(--accent-gold);">Idempotent Loads</h3>
      <p>Every load should be <strong>safely re-runnable</strong>. Running the same batch twice must not create duplicates or corrupt data.</p>
      <ul class="clean-list">
        <li>Use MERGE/upsert for dims, not blind INSERT</li>
        <li>For facts: DELETE + INSERT for the batch window, or use dbt's <code>unique_key</code> config</li>
        <li>Always include a <code>loaded_at</code> timestamp for debugging</li>
      </ul>
    </div>
    <div class="card blue card-wide">
      <h3 style="color:var(--accent-blue);">Error Handling &amp; Monitoring</h3>
      <ul class="clean-list">
        <li><strong>Row count alerts:</strong> If today's fact load is &lt;50% or &gt;200% of yesterday's ‚Äî investigate</li>
        <li><strong>Freshness checks:</strong> dbt <code>source freshness</code> tests alert if source data is stale</li>
        <li><strong>Reconciliation:</strong> Compare warehouse totals vs. source system totals periodically</li>
        <li><strong>Dead letter tables:</strong> Rows that fail validation go to a quarantine table for review</li>
      </ul>
    </div>
  </div>

  <div class="code-block" style="margin-top:2rem;">
    <div class="code-label">dbt Incremental Fact Pattern</div>
<pre>
<span class="kw">{{</span> config(
    materialized=<span class="st">'incremental'</span>,
    unique_key=<span class="st">'order_line_key'</span>,
    incremental_strategy=<span class="st">'merge'</span>
) <span class="kw">}}</span>

<span class="kw">SELECT</span>
    <span class="kw">{{</span> dbt_utils.generate_surrogate_key([<span class="st">'order_id'</span>, <span class="st">'line_number'</span>]) <span class="kw">}}</span> <span class="kw">AS</span> order_line_key,
    dim_date.date_key,
    dim_customer.customer_key,
    src.quantity,
    src.unit_price,
    src.quantity * src.unit_price <span class="kw">AS</span> line_total
<span class="kw">FROM</span> <span class="kw">{{</span> ref(<span class="st">'stg_orders'</span>) <span class="kw">}}</span> src
<span class="kw">LEFT JOIN</span> <span class="kw">{{</span> ref(<span class="st">'dim_date'</span>) <span class="kw">}}</span> <span class="kw">ON</span> src.order_date = dim_date.calendar_date
<span class="kw">LEFT JOIN</span> <span class="kw">{{</span> ref(<span class="st">'dim_customer'</span>) <span class="kw">}}</span> <span class="kw">ON</span> src.customer_id = dim_customer.customer_id
    <span class="kw">AND</span> dim_customer.is_current = <span class="kw">true</span>

<span class="cm">-- Lookback window for late-arriving facts</span>
<span class="kw">{% if</span> is_incremental() <span class="kw">%}</span>
<span class="kw">WHERE</span> src.order_date >= (<span class="kw">SELECT</span> <span class="kw">MAX</span>(calendar_date) - <span class="kw">INTERVAL</span> <span class="st">'3 days'</span> <span class="kw">FROM</span> <span class="kw">{{</span> this <span class="kw">}}</span> t <span class="kw">JOIN</span> <span class="kw">{{</span> ref(<span class="st">'dim_date'</span>) <span class="kw">}}</span> d <span class="kw">ON</span> t.date_key = d.date_key)
<span class="kw">{% endif %}</span>
</pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî NAMING CONVENTIONS (NEW) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="naming">
  <div class="section-header">
    <div class="section-number">Section 20</div>
    <h2 class="section-title">Naming Conventions &amp; Standards</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Consistent naming = readable queries = happy analysts. Adopt these standards on Day 1.</p>
  </div>

  <div class="diagram-container">
    <div class="diagram-title">Table Naming Convention</div>
    <table class="cheat-table">
      <thead><tr><th>Prefix</th><th>Layer</th><th>Example</th><th>Purpose</th></tr></thead>
      <tbody>
        <tr><td>stg_</td><td>Staging</td><td>stg_shopify__orders</td><td>1:1 source replica, cleaned</td></tr>
        <tr><td>int_</td><td>Intermediate</td><td>int_orders__enriched</td><td>Business logic, joins</td></tr>
        <tr><td>dim_</td><td>Mart (Dimension)</td><td>dim_customer</td><td>Descriptive context</td></tr>
        <tr><td>fct_</td><td>Mart (Fact)</td><td>fct_order_lines</td><td>Measurable events</td></tr>
        <tr><td>bridge_</td><td>Mart (Bridge)</td><td>bridge_order_promo</td><td>Many-to-many resolver</td></tr>
        <tr><td>rpt_</td><td>Reporting</td><td>rpt_monthly_revenue</td><td>Pre-aggregated for dashboards</td></tr>
      </tbody>
    </table>
  </div>

  <div class="grid-2" style="margin-top:2rem;">
    <div class="card teal card-wide">
      <h3>Column Naming Rules</h3>
      <table class="cheat-table">
        <thead><tr><th>Rule</th><th>Good ‚úÖ</th><th>Bad ‚ùå</th></tr></thead>
        <tbody>
          <tr><td>snake_case always</td><td>order_date</td><td>OrderDate, orderDate</td></tr>
          <tr><td>Full words, no abbreviations</td><td>customer_id</td><td>cust_id, cid</td></tr>
          <tr><td>Booleans: is_ or has_ prefix</td><td>is_active, has_discount</td><td>active_flag, disc_flg</td></tr>
          <tr><td>Dates: _at for timestamps, _date for dates</td><td>created_at, order_date</td><td>created, dt_ord</td></tr>
          <tr><td>Amounts: explicit unit</td><td>revenue_usd, weight_kg</td><td>amount, wt</td></tr>
          <tr><td>Keys: _key for surrogates, _id for natural</td><td>customer_key, customer_id</td><td>customer_sk, cust_nk</td></tr>
          <tr><td>Counts: _count suffix</td><td>order_count</td><td>num_orders, n_ord</td></tr>
          <tr><td>Percentages: _pct suffix</td><td>discount_pct</td><td>disc_perc, pctdisc</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card gold card-wide">
      <h3>Dimension Attribute Patterns</h3>
      <table class="cheat-table">
        <thead><tr><th>Pattern</th><th>Example</th></tr></thead>
        <tbody>
          <tr><td>Hierarchy levels: _l1, _l2, _l3</td><td>category_l1, category_l2</td></tr>
          <tr><td>SCD metadata: is_current, effective_start, effective_end</td><td>Always present on SCD2 dims</td></tr>
          <tr><td>Unknown rows: key = -1, attributes = 'Unknown'</td><td>-1, 'Unknown', 'N/A'</td></tr>
          <tr><td>Degenerate dims: live in fact table, no prefix</td><td>order_number, invoice_id</td></tr>
          <tr><td>Junk dim: dim_{context}_flags</td><td>dim_order_flags</td></tr>
          <tr><td>Role alias: {role}_date_key</td><td>ship_date_key, order_date_key</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî TESTING & DATA QUALITY (NEW) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="testing">
  <div class="section-header">
    <div class="section-number">Section 21</div>
    <h2 class="section-title">Testing &amp; Data Quality</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">A dimensional model without tests is a ticking time bomb. These checks keep your warehouse trustworthy.</p>
  </div>

  <div class="grid-2">
    <div class="card teal card-wide">
      <h3>Fact Table Tests</h3>
      <div class="process-steps" style="margin:1rem 0 0 0;">
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">1</div><div class="step-content"><h4 style="font-size:0.9rem;">Uniqueness at grain level</h4><p style="font-size:0.82rem;">Composite key (order_id + line_number) must be unique. If it's not, your grain is violated.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">2</div><div class="step-content"><h4 style="font-size:0.9rem;">Referential integrity</h4><p style="font-size:0.82rem;">Every FK in the fact must exist in its dimension. Test with <code>relationships</code> test in dbt.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">3</div><div class="step-content"><h4 style="font-size:0.9rem;">No NULL foreign keys</h4><p style="font-size:0.82rem;">Use <code>not_null</code> test on every FK. Orphan facts point to the "Unknown" dimension row.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">4</div><div class="step-content"><h4 style="font-size:0.9rem;">Measure sanity checks</h4><p style="font-size:0.82rem;">Revenue ‚â• 0, quantity > 0, discount_pct between 0 and 1. Use <code>accepted_range</code>.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">5</div><div class="step-content"><h4 style="font-size:0.9rem;">Row count monitoring</h4><p style="font-size:0.82rem;">Alert if today's fact load is ¬±50% from yesterday. Sudden drops = ETL failures.</p></div></div>
      </div>
    </div>

    <div class="card blue card-wide">
      <h3>Dimension Table Tests</h3>
      <div class="process-steps" style="margin:1rem 0 0 0;">
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">1</div><div class="step-content"><h4 style="font-size:0.9rem;">Surrogate key uniqueness</h4><p style="font-size:0.82rem;">customer_key must be unique and not null. Non-negotiable.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">2</div><div class="step-content"><h4 style="font-size:0.9rem;">SCD Type 2: exactly one current row per entity</h4><p style="font-size:0.82rem;">For each natural key, there must be exactly one row where <code>is_current = true</code>.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">3</div><div class="step-content"><h4 style="font-size:0.9rem;">SCD Type 2: no date gaps</h4><p style="font-size:0.82rem;">For each entity, effective_end of row N must equal effective_start of row N+1.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">4</div><div class="step-content"><h4 style="font-size:0.9rem;">"Unknown" row exists</h4><p style="font-size:0.82rem;">Key -1 must be present in every dimension with attributes set to 'Unknown'.</p></div></div>
        <div class="process-step" style="padding:0.8rem;"><div class="step-num" style="width:32px;height:32px;min-width:32px;font-size:0.7rem;">5</div><div class="step-content"><h4 style="font-size:0.9rem;">Enum validation</h4><p style="font-size:0.82rem;">loyalty_tier must be in ('Gold', 'Silver', 'Bronze', 'Unknown'). Use <code>accepted_values</code>.</p></div></div>
      </div>
    </div>
  </div>

  <div class="code-block" style="margin-top:1.5rem;">
    <div class="code-label">SQL: SCD Type 2 Integrity Check</div>
<pre>
<span class="cm">-- Find entities with more than one "current" row (should return 0 rows)</span>
<span class="kw">SELECT</span> customer_id, <span class="fn">COUNT</span>(*) <span class="kw">AS</span> current_count
<span class="kw">FROM</span> dim_customer
<span class="kw">WHERE</span> is_current = <span class="kw">TRUE</span>
<span class="kw">GROUP BY</span> customer_id
<span class="kw">HAVING</span> <span class="fn">COUNT</span>(*) > <span class="num">1</span>;

<span class="cm">-- Find date gaps in SCD2 history (should return 0 rows)</span>
<span class="kw">WITH</span> ranked <span class="kw">AS</span> (
    <span class="kw">SELECT</span> *, <span class="fn">LEAD</span>(effective_start) <span class="kw">OVER</span> (
        <span class="kw">PARTITION BY</span> customer_id <span class="kw">ORDER BY</span> effective_start
    ) <span class="kw">AS</span> next_start
    <span class="kw">FROM</span> dim_customer
)
<span class="kw">SELECT</span> * <span class="kw">FROM</span> ranked
<span class="kw">WHERE</span> next_start <span class="kw">IS NOT NULL</span>
  <span class="kw">AND</span> effective_end != next_start;
</pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî HANDS-ON EXERCISES (NEW) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="exercises">
  <div class="section-header">
    <div class="section-number">Section 22</div>
    <h2 class="section-title">Hands-On Exercises</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Practice these exercises to cement your understanding. Each builds on the previous one.</p>
  </div>

  <div class="exercise-box">
    <div class="exercise-title">Exercise 1: Declare the Grain</div>
    <div class="exercise-difficulty"><span class="level-badge level-simple">Beginner ‚Äî 10 min</span></div>
    <p>For each scenario below, write a one-sentence grain statement and identify whether the fact table is a transaction, periodic snapshot, or accumulating snapshot:</p>
    <ul class="clean-list" style="margin-top:0.75rem;">
      <li><strong>A:</strong> A fitness app tracking workouts. Users log exercises with sets, reps, and weight.</li>
      <li><strong>B:</strong> A bank recording daily account balances for every customer.</li>
      <li><strong>C:</strong> A university tracking student enrollment from application ‚Üí acceptance ‚Üí registration ‚Üí graduation.</li>
      <li><strong>D:</strong> An airline recording every flight booking with passenger, route, and price.</li>
    </ul>
    <p style="margin-top:1rem;color:var(--accent-blue);font-weight:600;">Hint: Ask "What is one row?" and "Does this row get updated, or is it insert-only?"</p>
  </div>

  <div class="exercise-box">
    <div class="exercise-title">Exercise 2: Design a Star Schema</div>
    <div class="exercise-difficulty"><span class="level-badge level-medium">Intermediate ‚Äî 20 min</span></div>
    <p>A food delivery app (think Uber Eats) wants to analyze orders. Design the complete star schema:</p>
    <ul class="clean-list" style="margin-top:0.75rem;">
      <li><strong>Step 1:</strong> State the business process and grain</li>
      <li><strong>Step 2:</strong> List all dimension tables with 5+ attributes each</li>
      <li><strong>Step 3:</strong> Define the fact table with all FKs, degenerate dimensions, and measures</li>
      <li><strong>Step 4:</strong> Identify which dimensions would be conformed if the company added a "driver ratings" star</li>
    </ul>
    <p style="margin-top:1rem;color:var(--accent-blue);font-weight:600;">Think about: dim_restaurant, dim_customer, dim_driver, dim_menu_item, dim_date, dim_payment_method, dim_geography</p>
  </div>

  <div class="exercise-box">
    <div class="exercise-title">Exercise 3: Write the SQL</div>
    <div class="exercise-difficulty"><span class="level-badge level-medium">Intermediate ‚Äî 15 min</span></div>
    <p>Using the coffee shop star schema from Section 13, write SQL queries to answer:</p>
    <ul class="clean-list" style="margin-top:0.75rem;">
      <li><strong>Q1:</strong> Which barista generated the most revenue last month?</li>
      <li><strong>Q2:</strong> What is the average transaction value by day of the week?</li>
      <li><strong>Q3:</strong> What are the top 3 seasonal drinks by total cups sold?</li>
      <li><strong>Q4:</strong> Compare weekend vs. weekday revenue for each drink category.</li>
    </ul>
  </div>

  <div class="exercise-box">
    <div class="exercise-title">Exercise 4: SCD Type 2 Scenario</div>
    <div class="exercise-difficulty"><span class="level-badge level-advanced">Advanced ‚Äî 20 min</span></div>
    <p>A customer (customer_id = 'C-1001') exists in your dim_customer with:</p>
    <div class="code-block"><pre>customer_key=42, name='Hans', city='Munich', loyalty='Silver',
is_current=true, eff_start='2023-01-15', eff_end='9999-12-31'</pre></div>
    <p style="margin-top:0.75rem;">On 2025-02-01, Hans moves to Berlin AND gets upgraded to Gold tier. Write:</p>
    <ul class="clean-list">
      <li><strong>A:</strong> The UPDATE statement to close the old row</li>
      <li><strong>B:</strong> The INSERT statement for the new row</li>
      <li><strong>C:</strong> A query to find all of Hans's orders when he was still in Munich</li>
    </ul>
  </div>

  <div class="exercise-box">
    <div class="exercise-title">Exercise 5: Build a Bus Matrix</div>
    <div class="exercise-difficulty"><span class="level-badge level-advanced">Advanced ‚Äî 25 min</span></div>
    <p>You're the data architect for a <strong>hotel chain</strong>. The business processes are: room bookings, guest check-ins, restaurant dining, spa appointments, housekeeping tasks, and loyalty point transactions.</p>
    <ul class="clean-list" style="margin-top:0.75rem;">
      <li><strong>Step 1:</strong> Create the Bus Matrix (process √ó dimensions grid)</li>
      <li><strong>Step 2:</strong> Identify which dimensions are conformed</li>
      <li><strong>Step 3:</strong> Recommend which star to build first and explain why</li>
      <li><strong>Step 4:</strong> Design the fact table for "room bookings" with all FKs and measures</li>
    </ul>
  </div>

  <div class="exercise-box">
    <div class="exercise-title">Exercise 6: dbt Implementation</div>
    <div class="exercise-difficulty"><span class="level-badge level-complex">Expert ‚Äî 30 min</span></div>
    <p>Using the food delivery star schema from Exercise 2, write complete dbt models:</p>
    <ul class="clean-list" style="margin-top:0.75rem;">
      <li><strong>A:</strong> A staging model for the source orders table</li>
      <li><strong>B:</strong> A dim_restaurant dimension model with a surrogate key</li>
      <li><strong>C:</strong> A fct_delivery_orders fact model that joins all dimensions</li>
      <li><strong>D:</strong> A schema.yml file with at least 3 tests per model</li>
    </ul>
  </div>
</section>



<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEW ‚Äî SEMANTIC / METRICS LAYER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="semantic-layer">
  <div class="section-header">
    <div class="section-number">Section 23</div>
    <h2 class="section-title">Semantic &amp; Metrics Layer</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">The bridge between your star schemas and your consumers ‚Äî defining "one source of truth" for metrics.</p>
  </div>

  <div class="callout callout-info">
    <h4>What Is a Semantic Layer?</h4>
    <p>A semantic layer sits <strong>on top of your Kimball star schemas</strong> and provides a business-friendly abstraction: metric definitions, relationships, hierarchies, and access controls. It ensures that "revenue" means the same thing in every dashboard, API call, and AI query ‚Äî regardless of who's asking or which tool they're using.</p>
  </div>

  <div class="diagram-container" style="margin-top:2rem;">
    <div class="diagram-title">Where the Semantic Layer Sits</div>
    <div class="flow-row" style="margin:1.5rem 0;flex-wrap:wrap;justify-content:center;">
      <div class="flow-box" style="background:var(--accent-blue-dim);color:var(--accent-blue);border-color:rgba(59,130,246,0.3);">
        <strong>üìä Sources</strong><br><span style="font-size:0.78rem;">Shopify, Stripe,<br>Salesforce, GA4</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-purple-dim);color:var(--accent-purple);border-color:rgba(167,139,250,0.3);">
        <strong>‚öôÔ∏è dbt</strong><br><span style="font-size:0.78rem;">staging ‚Üí intermediate<br>‚Üí star schemas</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-gold-dim);color:var(--accent-gold);border-color:rgba(240,197,91,0.3);">
        <strong>üß† Semantic Layer</strong><br><span style="font-size:0.78rem;">Metric definitions,<br>relationships, access</span>
      </div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-box" style="background:var(--accent-teal-dim);color:var(--accent-teal);border-color:rgba(45,212,191,0.3);">
        <strong>üì± Consumers</strong><br><span style="font-size:0.78rem;">Dashboards, AI/LLM,<br>APIs, Notebooks</span>
      </div>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Why Kimball + Semantic Layer Is Powerful</h4>
  <div class="grid-2">
    <div class="card rose card-wide">
      <h3 style="color:var(--accent-rose);">Without Semantic Layer</h3>
      <ul class="clean-list">
        <li>Dashboard A calculates revenue as <code>SUM(line_total)</code></li>
        <li>Dashboard B calculates revenue as <code>SUM(line_total) - SUM(discount)</code></li>
        <li>AI chatbot generates its own SQL with a third definition</li>
        <li>CFO asks "which number is right?" ‚Üí <strong>nobody knows</strong></li>
      </ul>
    </div>
    <div class="card teal card-wide">
      <h3 style="color:var(--accent-teal);">With Semantic Layer ‚≠ê</h3>
      <ul class="clean-list">
        <li>"Net Revenue" is defined <em>once</em>: <code>SUM(line_total - discount_amount)</code></li>
        <li>Every consumer ‚Äî dashboards, AI, APIs ‚Äî uses the <strong>same definition</strong></li>
        <li>Changes propagate everywhere automatically</li>
        <li>CFO gets <strong>one consistent number</strong> everywhere</li>
      </ul>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Popular Semantic Layer Tools</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Tool</th><th>Type</th><th>Key Strength</th><th>Best With</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>dbt Metrics / MetricFlow</strong></td><td>Code-first (YAML)</td><td>Version-controlled, integrated with dbt</td><td>dbt Core / dbt Cloud</td></tr>
        <tr><td><strong>Cube</strong></td><td>Universal semantic layer</td><td>Multi-tool: serves BI, AI, APIs simultaneously</td><td>Any warehouse + any BI tool</td></tr>
        <tr><td><strong>Looker (LookML)</strong></td><td>Embedded in BI tool</td><td>Mature, governed, strong for enterprise</td><td>Looker / Google Cloud</td></tr>
        <tr><td><strong>AtScale</strong></td><td>Virtual OLAP</td><td>MDX/DAX compatibility, Excel pivot tables</td><td>Enterprise BI (Power BI, Tableau)</td></tr>
        <tr><td><strong>Lightdash / Mode</strong></td><td>BI with metrics</td><td>Lightweight, dbt-native metric support</td><td>Startup / growth analytics teams</td></tr>
      </tbody>
    </table>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">How Metrics Map to Kimball Concepts</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Kimball Concept</th><th>Semantic Layer Equivalent</th><th>Example</th></tr>
      </thead>
      <tbody>
        <tr><td>Fact table measure</td><td>Metric definition</td><td><code>net_revenue = SUM(fct_order_lines.line_total - fct_order_lines.discount)</code></td></tr>
        <tr><td>Dimension attribute</td><td>Dimension / entity property</td><td><code>dim_customer.loyalty_tier</code></td></tr>
        <tr><td>Dimension hierarchy</td><td>Drill-down path</td><td><code>category ‚Üí subcategory ‚Üí product</code></td></tr>
        <tr><td>Conformed dimension</td><td>Shared / joined entity</td><td><code>dim_date</code> used across all metrics</td></tr>
        <tr><td>Grain</td><td>Metric granularity</td><td>"daily revenue per product" ‚Üí time_grains: [day, week, month]</td></tr>
        <tr><td>Additive / semi-additive</td><td>Aggregation type</td><td><code>type: sum</code> vs <code>type: average</code> vs <code>type: count_distinct</code></td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout callout-key" style="margin-top:2rem;">
    <h4>üîë AI/LLM Connection</h4>
    <p>The semantic layer is the <strong>secret weapon for text-to-SQL and AI analytics</strong>. When an LLM can query a semantic layer instead of writing raw SQL against star schemas, it gets: pre-defined metric logic, validated join paths, access-controlled data, and business-friendly naming. This is why Kimball + semantic layer is becoming the gold standard for AI-powered analytics.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Restaurant Menu</div>
    <p>Your star schemas are the <strong>kitchen</strong> ‚Äî ingredients organized and prepped. The semantic layer is the <strong>menu</strong> ‚Äî it translates kitchen internals into customer-friendly descriptions. The customer (dashboard, AI, analyst) orders "Margherita Pizza" (a metric) without knowing the exact recipe. If the chef changes suppliers (source system change) or tweaks the recipe (metric logic update), the menu item name stays the same and all customers get the improved version automatically.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NEW ‚Äî PERFORMANCE TUNING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="performance-tuning">
  <div class="section-header">
    <div class="section-number">Section 24</div>
    <h2 class="section-title">Performance Tuning for Star Schemas</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Making your dimensional models fast in production ‚Äî partitioning, clustering, materialization, and query optimization.</p>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:1rem 0 1.5rem;font-size:1.4rem;">Physical Design Strategies</h4>
  <div class="grid-2">
    <div class="card blue card-wide">
      <h3 style="color:var(--accent-blue);">üì¶ Partitioning</h3>
      <p>Split large tables into smaller physical segments based on a key column.</p>
      <ul class="clean-list">
        <li><strong>Fact tables:</strong> Partition by date (month/day) ‚Äî most queries filter by time range</li>
        <li><strong>Effect:</strong> Query scans only relevant partitions, skipping 90%+ of data</li>
        <li><strong>BigQuery:</strong> <code>PARTITION BY DATE(order_date)</code></li>
        <li><strong>Snowflake:</strong> Automatic micro-partitioning (no manual config needed)</li>
        <li><strong>Rule of thumb:</strong> Partition when table exceeds 1 billion rows or 1 TB</li>
      </ul>
    </div>
    <div class="card purple card-wide">
      <h3 style="color:var(--accent-purple);">üóÇÔ∏è Clustering / Sort Keys</h3>
      <p>Organize data within partitions for efficient filtering and joining.</p>
      <ul class="clean-list">
        <li><strong>Fact tables:</strong> Cluster on most-filtered dimension keys (date_key, customer_key)</li>
        <li><strong>Dimension tables:</strong> Cluster on business key or most-queried attributes</li>
        <li><strong>BigQuery:</strong> <code>CLUSTER BY customer_key, product_key</code></li>
        <li><strong>Snowflake:</strong> <code>CLUSTER BY (date_key, channel_key)</code></li>
        <li><strong>Max 3-4 cluster keys</strong> ‚Äî diminishing returns beyond that</li>
      </ul>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Materialization Strategy</h4>
  <div class="card blue card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Materialization</th><th>What It Does</th><th>Best For</th><th>Cost</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>View</strong></td>
          <td>SQL definition only ‚Äî computed on every query</td>
          <td>Staging models, light transforms, rarely-queried models</td>
          <td>Zero storage, high compute per query</td>
        </tr>
        <tr>
          <td><strong>Table</strong></td>
          <td>Fully materialized ‚Äî rebuilt from scratch each dbt run</td>
          <td>Dimensions (usually small), lookup tables</td>
          <td>Full storage, full rebuild time</td>
        </tr>
        <tr>
          <td><strong>Incremental</strong></td>
          <td>Only processes new/changed rows</td>
          <td>Large fact tables (millions+ rows) ‚Äî the star pattern</td>
          <td>Low rebuild time, needs careful design</td>
        </tr>
        <tr>
          <td><strong>Materialized View</strong></td>
          <td>Auto-refreshed by the warehouse engine</td>
          <td>Aggregate tables, frequently-queried summaries</td>
          <td>Storage + auto-refresh compute</td>
        </tr>
        <tr>
          <td><strong>Ephemeral</strong></td>
          <td>CTEs compiled into downstream models</td>
          <td>Reusable intermediate logic (not persisted)</td>
          <td>Zero storage, zero standalone cost</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="code-block" style="margin-top:2rem;">
    <div class="code-label">Recommended dbt Materialization by Layer</div>
<pre>
<span class="cm"># dbt_project.yml</span>
models:
  my_project:
    staging:
      +materialized: <span class="st">view</span>           <span class="cm"># Light transforms, cheap</span>
    intermediate:
      +materialized: <span class="st">ephemeral</span>      <span class="cm"># CTEs, no extra tables</span>
    marts:
      dims:
        +materialized: <span class="st">table</span>        <span class="cm"># Small, full refresh OK</span>
      facts:
        +materialized: <span class="st">incremental</span>   <span class="cm"># Large, append-heavy</span>
      aggregates:
        +materialized: <span class="st">table</span>        <span class="cm"># Or materialized_view</span>
</pre>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Query Optimization Techniques</h4>
  <div class="grid-3">
    <div class="card gold">
      <h3>Aggregate Tables</h3>
      <ul class="clean-list">
        <li>Pre-compute common rollups: daily ‚Üí monthly ‚Üí yearly</li>
        <li>Dashboard hitting <code>fct_order_lines</code> 500M rows? Build <code>fct_orders_monthly</code></li>
        <li><strong>Always keep atomic grain</strong> ‚Äî aggregates are additions, not replacements</li>
        <li>Some BI tools auto-route to the right agg level</li>
      </ul>
    </div>
    <div class="card teal">
      <h3>Join Optimization</h3>
      <ul class="clean-list">
        <li>Star schema = few joins (1 fact + N dims) ‚Äî already optimized</li>
        <li>Use integer/hash surrogate keys ‚Äî faster than string joins</li>
        <li>Filter on the fact table <em>first</em>, then join dims</li>
        <li>Avoid <code>SELECT *</code> ‚Äî columnar stores only read requested columns</li>
      </ul>
    </div>
    <div class="card rose">
      <h3>BI Layer Tricks</h3>
      <ul class="clean-list">
        <li><strong>Extracts/caches:</strong> Tableau extracts, Looker PDTs for heavy dashboards</li>
        <li><strong>Query tagging:</strong> Tag queries by dashboard/user for cost attribution</li>
        <li><strong>Result caching:</strong> Snowflake caches identical queries for 24h for free</li>
        <li><strong>Warehouse sizing:</strong> Scale up for heavy transforms, scale down for BI queries</li>
      </ul>
    </div>
  </div>

  <h4 style="font-family:'Playfair Display',serif;margin:2.5rem 0 1.5rem;font-size:1.4rem;">Performance Anti-Patterns to Avoid</h4>
  <div class="card rose card-wide">
    <table class="styled-table">
      <thead>
        <tr><th>Anti-Pattern</th><th>Why It Hurts</th><th>Fix</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>Full table scan on facts</strong></td><td>Scans 500M+ rows every query</td><td>Always filter by date partition + cluster keys</td></tr>
        <tr><td><strong>SELECT * FROM fact</strong></td><td>Reads all columns in columnar store</td><td>Select only needed columns</td></tr>
        <tr><td><strong>String-based joins</strong></td><td>Comparing varchar is 3-5√ó slower than int/hash</td><td>Use surrogate integer or hash keys for joins</td></tr>
        <tr><td><strong>No incremental on large facts</strong></td><td>Rebuilds 500M rows daily when only 50K are new</td><td>Use dbt incremental with merge strategy</td></tr>
        <tr><td><strong>Over-normalized (snowflake) dims</strong></td><td>Extra joins for every query, no performance gain</td><td>Denormalize into star schema ‚Äî storage is cheap</td></tr>
        <tr><td><strong>Too many materializations</strong></td><td>Warehouse filled with unused tables eating storage + refresh time</td><td>Audit unused models quarterly, convert to views</td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout callout-key" style="margin-top:2rem;">
    <h4>üîë The 80/20 Rule of Performance</h4>
    <p>In most Kimball implementations, <strong>80% of performance gains</strong> come from three things: (1) partitioning facts by date, (2) using incremental materializations for large facts, and (3) building 2-3 aggregate tables for the heaviest dashboards. Everything else is optimization at the margins. Get these three right before pursuing exotic tuning.</p>
  </div>

  <div class="analogy-box">
    <div class="analogy-title">Analogy ‚Äî Library Organization</div>
    <p><strong>Partitioning</strong> is organizing books by floor (Fiction floor 1, Non-fiction floor 2) ‚Äî you go directly to the right floor. <strong>Clustering</strong> is alphabetizing within each floor ‚Äî you find the exact shelf fast. <strong>Aggregate tables</strong> are the "Popular Picks" display at the entrance ‚Äî the 20 most-requested books without searching the stacks. <strong>Materialized views</strong> are pre-compiled reading lists that auto-update when new books arrive.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî BEST PRACTICES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="best-practices">
  <div class="section-header">
    <div class="section-number">Section 25</div>
    <h2 class="section-title">Best Practices &amp; Anti-Patterns</h2>
    <div class="section-divider"></div>
  </div>
  <div class="grid-2">
    <div class="card teal card-wide">
      <h3 style="color:var(--accent-teal);">‚úÖ Do This</h3>
      <ul class="clean-list">
        <li><strong>Declare grain first</strong> ‚Äî if you can't state it in one sentence, stop</li>
        <li><strong>Surrogate keys on every dimension</strong> ‚Äî protect against source changes + enable SCD2</li>
        <li><strong>Conformed dimensions from Day 1</strong> ‚Äî design for reuse across future stars</li>
        <li><strong>Atomic grain</strong> ‚Äî store lowest detail; build aggregates separately</li>
        <li><strong>dim_date on every fact</strong> ‚Äî almost every question involves time</li>
        <li><strong>Descriptive column names</strong> ‚Äî <code>is_weekend</code>, not <code>wknd_flg</code></li>
        <li><strong>"Unknown" rows</strong> ‚Äî key=-1 in every dimension; never leave NULLs in FKs</li>
        <li><strong>Version control your models</strong> ‚Äî dbt + Git = auditable, testable warehouse</li>
      </ul>
    </div>
    <div class="card rose card-wide">
      <h3 style="color:var(--accent-rose);">üö´ Avoid This</h3>
      <ul class="clean-list">
        <li><strong>Centipede fact tables</strong> ‚Äî 50+ FKs means mixed grains; split them</li>
        <li><strong>Operational keys as PKs</strong> ‚Äî source IDs change; always use surrogates</li>
        <li><strong>NULL foreign keys</strong> ‚Äî point to "Unknown" row instead</li>
        <li><strong>Storing ratios as facts</strong> ‚Äî store numerator + denominator; compute at query time</li>
        <li><strong>Skipping the Bus Matrix</strong> ‚Äî leads to incompatible dimensions</li>
        <li><strong>Over-snowflaking</strong> ‚Äî space savings are negligible vs. the join cost</li>
        <li><strong>Mixing grains</strong> ‚Äî order-level and line-level in the same fact = disaster</li>
        <li><strong>No tests</strong> ‚Äî unvalidated models erode trust faster than you can build it</li>
      </ul>
    </div>
  </div>
  <div class="callout callout-tip" style="margin-top:2rem;">
    <h4>The Golden Rule</h4>
    <p><strong>"Can a business user write a GROUP BY query without calling IT?"</strong> If yes, your model is on track.</p>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 20 ‚Äî CHEAT SHEET (NEW) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="cheatsheet">
  <div class="section-header">
    <div class="section-number">Section 26</div>
    <h2 class="section-title">Quick Reference Cheat Sheet</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">Print this. Pin it above your desk. Reference it during every modeling session.</p>
  </div>

  <div class="grid-2">
    <div class="card gold card-wide">
      <h3>The 4-Step Process</h3>
      <table class="cheat-table">
        <tbody>
          <tr><td>1. Process</td><td>What repeatable business event are we modeling?</td></tr>
          <tr><td>2. Grain</td><td>What does one row represent? (Most atomic level)</td></tr>
          <tr><td>3. Dimensions</td><td>How will users slice/filter? (Who, what, where, when, why)</td></tr>
          <tr><td>4. Facts</td><td>What numeric measures result? (Must be true at grain)</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card blue card-wide">
      <h3>Fact Table Types</h3>
      <table class="cheat-table">
        <tbody>
          <tr><td>Transaction</td><td>1 row per event. Insert-only. Fully additive.</td></tr>
          <tr><td>Periodic Snapshot</td><td>1 row per entity per period. Semi-additive.</td></tr>
          <tr><td>Accumulating Snapshot</td><td>1 row per lifecycle. Updated at milestones.</td></tr>
          <tr><td>Factless</td><td>No measures ‚Äî records event occurrence or coverage.</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card teal card-wide">
      <h3>SCD Types</h3>
      <table class="cheat-table">
        <tbody>
          <tr><td>Type 0</td><td>Never change. Retain original forever.</td></tr>
          <tr><td>Type 1</td><td>Overwrite. No history. Current state only.</td></tr>
          <tr><td>Type 2</td><td>New row + surrogate key. Full history. ‚≠ê Most used.</td></tr>
          <tr><td>Type 3</td><td>Add column. Previous vs. current only.</td></tr>
          <tr><td>Type 6</td><td>Hybrid (1+2+3). Maximum flexibility.</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card purple card-wide">
      <h3>Advanced Patterns</h3>
      <table class="cheat-table">
        <tbody>
          <tr><td>Role-Playing Dim</td><td>Same table, multiple FKs (order_date, ship_date)</td></tr>
          <tr><td>Junk Dimension</td><td>Low-cardinality flags bundled into one dim</td></tr>
          <tr><td>Bridge Table</td><td>Many-to-many resolver with weighting factors</td></tr>
          <tr><td>Mini-Dimension</td><td>Volatile attributes extracted from main dim</td></tr>
          <tr><td>Degenerate Dim</td><td>Dimension value stored directly in fact (order_number)</td></tr>
          <tr><td>Conformed Dim</td><td>Shared identically across multiple fact tables</td></tr>
          <tr><td>Outrigger</td><td>Sub-table for product-type-specific attributes</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card orange card-wide">
      <h3>Measure Types</h3>
      <table class="cheat-table">
        <tbody>
          <tr><td>Additive</td><td>Sum across ALL dims. Revenue, quantity, cost.</td></tr>
          <tr><td>Semi-Additive</td><td>Sum across SOME dims (not time). Balance, inventory.</td></tr>
          <tr><td>Non-Additive</td><td>Cannot sum. Ratios, percentages. Compute at query time.</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card rose card-wide">
      <h3>Essential Tests Checklist</h3>
      <table class="cheat-table">
        <tbody>
          <tr><td>‚úÖ Fact grain unique</td><td>Composite PK must be unique + not null</td></tr>
          <tr><td>‚úÖ FK ‚Üí PK integrity</td><td>Every FK exists in its dimension table</td></tr>
          <tr><td>‚úÖ No NULL FKs</td><td>Use "Unknown" row (key=-1) instead</td></tr>
          <tr><td>‚úÖ SCD2: 1 current row</td><td>Per natural key, exactly 1 is_current=true</td></tr>
          <tr><td>‚úÖ Measure ranges</td><td>Revenue ‚â• 0, qty > 0, pct between 0‚Äì1</td></tr>
          <tr><td>‚úÖ Row count alerts</td><td>¬±50% from yesterday = investigate</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê 21 ‚Äî Q&A ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section class="section" id="qa">
  <div class="section-header">
    <div class="section-number">Section 27</div>
    <h2 class="section-title">Comprehensive Q&amp;A</h2>
    <div class="section-divider"></div>
    <p class="section-subtitle">25 questions covering beginner to expert topics.</p>
  </div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q1</div><span>Why not just use a flat "One Big Table" for analytics?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">A single flat table works at small scale but fails when: (1) Massive data duplication ‚Äî every order row repeats the entire customer profile. (2) Update anomalies ‚Äî changing a customer's city means updating millions of rows. (3) Consistency issues ‚Äî if you update in one place but not another, you get conflicting data. Star schemas store dimension data once; fact tables carry lightweight FKs. That said, an OBT materialized view <em>on top of</em> a star schema can be a valid performance optimization for specific dashboards.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q2</div><span>What exactly is a "grain" and why is it so important?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">The grain is a precise statement of what one row represents ‚Äî e.g., "one line item on one sales receipt at one store on one day." If the grain is wrong, you get double-counting (too coarse) or impossible queries (too fine). Test: can you describe it in one plain-English sentence? If you need caveats, you have a mixed-grain problem ‚Äî split into separate fact tables.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q3</div><span>Why use surrogate keys instead of business keys?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Business keys can change (mergers), collide across source systems (customer 12345 in system A ‚â† in system B), and can't handle SCD Type 2 (multiple rows need unique PKs while sharing the same business key). Integer surrogates are also faster for joins. Always keep the business key as an attribute for traceability.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q4</div><span>When should I use SCD Type 2 vs. Type 1?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner"><strong>Type 1</strong> when the old value was wrong (typo) or history doesn't matter. <strong>Type 2</strong> when you need "as was" vs. "as is" analysis ‚Äî e.g., revenue by customer segment <em>at the time of purchase</em>. Common Type 2: address, segment, loyalty tier. Common Type 1: name corrections, email updates. Discuss with business stakeholders which attributes need historical tracking.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q5</div><span>What is a conformed dimension?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">A dimension table shared identically across multiple fact tables ‚Äî same keys, attributes, and hierarchies. dim_date is the classic example. This is what makes the Bus Architecture work: because orders and returns share the same dim_customer, you can compare data across both processes. Without conformity, you get "stovepipe" marts with conflicting definitions.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q6</div><span>What is a degenerate dimension?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">A dimension key that lives directly in the fact table without its own dimension table ‚Äî typically an order number, invoice number, or transaction ID. You can filter/group by it, but there's no separate table because there are no additional attributes worth storing. Creating a one-column dim table would be wasteful.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q7</div><span>Additive vs. semi-additive vs. non-additive?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner"><strong>Additive</strong>: sum across all dims (revenue, qty, cost). <strong>Semi-additive</strong>: sum across some dims but NOT time (account balance ‚Äî you can sum across customers but not months). <strong>Non-additive</strong>: can't sum at all (unit price, percentages, ratios). Store components as additive; compute ratios at query time.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q8</div><span>How does Kimball work with dbt in practice?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">dbt is "Kimball as code." <code>staging/</code> = cleaned source replicas. <code>intermediate/</code> = business logic and joins. <code>marts/</code> = star schemas (dim_ and fct_ models). Surrogate keys via <code>dbt_utils.generate_surrogate_key()</code>. SCD Type 2 via dbt snapshots. Referential integrity via <code>relationships</code> tests. Your entire Kimball warehouse becomes version-controlled, testable, documentable SQL.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q9</div><span>What is the Bus Matrix?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">A grid: rows = business processes (fact tables), columns = dimensions. Checkmarks show which dimensions participate in which processes. Shared columns are conformed dimensions. It's both a planning tool (what to build next) and a communication tool (showing stakeholders how marts connect). Build it during requirements, use it to prioritize which star to build first.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q10</div><span>How do I handle NULL foreign keys?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Never allow NULL FKs. Create an "Unknown" row in each dimension (key = -1, attributes = 'Unknown'). Benefits: (1) INNER JOINs don't lose rows. (2) GROUP BYs show clean "Unknown" instead of NULL. (3) You can distinguish "don't know" (Unknown) from "doesn't apply" (N/A) with separate default rows.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q11</div><span>Star vs. Snowflake ‚Äî which should I use?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Star schema in almost all cases. A 50K-row dim_product with some redundancy is a rounding error next to a 500M-row fact table. Snowflake only when: (1) dimension has millions of rows with a deep hierarchy, (2) strict governance demands normalization, (3) very deep hierarchy (10+ levels). Modern cloud warehouses with cheap columnar storage make the star schema's minor redundancy irrelevant.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q12</div><span>How do I handle many-to-many relationships?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Bridge table. Create a mapping table with a "group key" linking to individual dimension keys. Include a weighting factor (summing to 1.0 per group) to prevent double-counting during aggregations. Works for: patient-diagnoses, order-promotions, student-courses, account-holders on joint accounts.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q13</div><span>What is a junk dimension?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">A catch-all dimension combining multiple low-cardinality flags: is_gift_wrap, is_expedited, payment_type, is_first_order. Pre-compute all combinations (e.g., 2√ó2√ó3√ó2 = 24 rows). Replaces 4+ fact columns with 1 FK. Use when you have 3+ low-cardinality categoricals that don't fit any existing dimension. Don't put high-cardinality attributes in junk dims.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q14</div><span>How does Kimball handle real-time / streaming data?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Traditional Kimball was batch, but adapts well: (1) <strong>Micro-batch</strong>: run dbt every 5‚Äì15 min. (2) <strong>Streaming inserts</strong>: Snowpipe / BigQuery Streaming API append to facts in near-real-time; dims update slower. (3) <strong>Materialized views</strong>: incrementally maintained as base tables change. Key insight: dimensions rarely need real-time updates ‚Äî the streaming challenge is mostly appending new fact rows quickly.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q15</div><span>Is Kimball still relevant in the age of AI/LLMs?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">More relevant than ever. LLMs doing text-to-SQL perform dramatically better with star schemas because: (1) Intuitive column names give strong semantic signals. (2) Simple join patterns (fact ‚Üí dim) are easy for AI to generate correctly. (3) Conformed dimensions reduce ambiguity. (4) Business-meaningful naming (dim_customer, fct_orders) helps LLMs. Companies investing in "semantic layers" are building them on top of Kimball-modeled warehouses. Kimball is becoming the foundation for AI-powered analytics.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q16</div><span>What is a factless fact table?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">A fact table with no numeric measures ‚Äî only FKs. Two types: (1) <strong>Event-tracking</strong>: "student attended class Y on date Z." (2) <strong>Coverage</strong>: "promo X was active for product Y at store Z." Coverage tables answer "what was promoted but had zero sales?" ‚Äî impossible without them because absence of a row in the sales fact is ambiguous.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q17</div><span>How do I handle late-arriving facts and dimensions?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner"><strong>Late facts</strong>: Insert with the correct date_key ‚Äî they land in the right period. Adjust ETL to handle backdated records. <strong>Late dimensions</strong>: Create a placeholder row (attributes = 'Pending'). When data arrives, update via SCD Type 1. This ensures fact rows always have valid FKs and are never orphaned.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q18</div><span>How does Kimball handle hierarchies?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Flatten them into the dimension: <code>category_l1</code>, <code>category_l2</code>, <code>category_l3</code>. Some redundancy (category name repeated per product), but queries are trivial ‚Äî <code>GROUP BY category_l1</code> with no extra joins. For ragged hierarchies (variable depth, like org charts), use a bridge table with parent-child relationships and level indicators.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q19</div><span>Which business process should I model first?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Score on three criteria: (1) <strong>Business value</strong>: Which process, analyzed better, has biggest impact? (2) <strong>Feasibility</strong>: Is source data available and clean? (3) <strong>Conformity leverage</strong>: Does it establish dim_customer, dim_product, dim_date that future stars reuse? For most companies, "sales/orders" wins on all three.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q20</div><span>Can I use Kimball with a data lakehouse?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Absolutely. The medallion architecture maps perfectly: Bronze = raw landing, Silver = cleaned/standardized, Gold = Kimball star schemas. Delta Lake supports ACID transactions, MERGE (critical for SCD2), and time travel. The lakehouse gives you flexible storage for ML workloads plus disciplined dimensional models for BI.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q21</div><span>Data mart vs. data warehouse?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">In Kimball: a data mart = one star schema (one business process). The data warehouse = all connected marts sharing conformed dimensions. There's no separate "warehouse" database above the marts. The warehouse emerges as you build more stars. One star = one mart. Constellation of connected stars = enterprise warehouse.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q22</div><span>What's the relationship between Kimball and the "One Big Table" trend?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">OBT is Kimball's denormalization taken to the extreme ‚Äî pre-joining everything into one table. Works for: single dashboards, small datasets, maximum analyst simplicity. Fails for: cross-process analysis (no conformed dims), frequent changes (update nightmare), very wide tables (unwieldy). Pragmatic approach: build Kimball stars as source of truth, then materialize OBTs as downstream views for specific dashboards.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q23</div><span>How do role-playing dimensions work?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Same physical dimension table referenced multiple times with different aliases. An orders fact has order_date_key, ship_date_key, delivery_date_key ‚Äî all pointing to dim_date. In SQL, alias each join differently. In BI tools, create separate "views" per role. The alternative (three identical date tables) would violate DRY and triple maintenance effort.</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q24</div><span>What are aggregate fact tables and when should I use them?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">Pre-computed summaries at a coarser grain ‚Äî e.g., <code>fct_daily_sales_summary</code> that aggregates the atomic <code>fct_order_lines</code> to one row per product per store per day. Use them when: queries against the atomic fact are too slow for interactive dashboards. Always keep the atomic fact as the source of truth and build aggregates on top ‚Äî never replace the detail with the summary. Modern cloud warehouses have reduced the need for aggregates thanks to automatic caching and clustering, but they still help for truly massive tables (billions of rows).</div></div></div>

  <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)"><div style="display:flex;align-items:center;gap:0.75rem;"><div class="q-icon">Q25</div><span>What are the most common beginner mistakes?</span></div><div class="qa-toggle">‚ñº</div></div><div class="qa-answer"><div class="qa-answer-inner">(1) <strong>Skipping grain declaration</strong> ‚Äî jumping to columns without agreeing what a row means. (2) <strong>Mixing grains</strong> ‚Äî order-level and line-level in the same fact. (3) <strong>Copying OLTP schemas</strong> ‚Äî facts and dims should be modeled for analytics, not copied from the source. (4) <strong>Too many tiny dims</strong> ‚Äî dim_color with 12 rows is better as a product attribute. (5) <strong>Ignoring the Bus Matrix</strong>. (6) <strong>Over-engineering SCDs</strong> ‚Äî applying Type 2 to every attribute. (7) <strong>Forgetting the "Unknown" row</strong>. (8) <strong>Not testing</strong> ‚Äî a single broken FK erodes trust in the entire warehouse.</div></div></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FOOTER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<footer class="footer">
  <div class="footer-links">
    <a href="https://www.linkedin.com/in/varuntyagi83/" target="_blank" rel="noopener">LinkedIn</a>
    <a href="https://github.com/varuntyagi83" target="_blank" rel="noopener">GitHub</a>
    <a href="https://medium.com/@varun.tyagi83" target="_blank" rel="noopener">Medium</a>
    <a href="https://www.meetvaruntyagi.com" target="_blank" rel="noopener">Portfolio</a>
  </div>
  <div class="footer-credit">Crafted for the <strong style="color:var(--accent-gold);">AI Catalyst Cohort</strong> by Varun Tyagi</div>
  <div style="color:var(--text-muted);font-size:0.75rem;margin-top:0.5rem;">¬© 2026 ‚Äî Built on Kimball's timeless principles for the modern data era</div>
</footer>

</div><!-- end main-content -->

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION ‚Äî Dropdowns, Hamburger, Mobile Menu
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Smooth scroll helper ‚Äî used by all nav items
function scrollToTarget(targetId) {
  var el = document.getElementById(targetId);
  if (el) {
    el.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
}

// Desktop dropdown + sub-item clicks
document.querySelectorAll('.nav-sub-item[data-target], .nav-item[data-target]').forEach(function(item) {
  item.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    var targetId = this.getAttribute('data-target');
    if (targetId) scrollToTarget(targetId);
    // Close any open dropdown
    document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
  });
});

// Hamburger toggle
var hamburgerBtn = document.getElementById('hamburgerBtn');
var mobileMenu = document.getElementById('mobileMenu');

hamburgerBtn.addEventListener('click', function() {
  this.classList.toggle('active');
  mobileMenu.classList.toggle('open');
  document.body.style.overflow = mobileMenu.classList.contains('open') ? 'hidden' : '';
});

// Mobile menu item clicks
document.querySelectorAll('.mobile-menu-item[data-target]').forEach(function(item) {
  item.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    var targetId = this.getAttribute('data-target');
    // Close mobile menu
    hamburgerBtn.classList.remove('active');
    mobileMenu.classList.remove('open');
    document.body.style.overflow = '';
    // Scroll after a brief delay to let menu close
    setTimeout(function() { scrollToTarget(targetId); }, 100);
  });
});

// Close dropdowns when clicking outside
document.addEventListener('click', function(e) {
  if (!e.target.closest('.nav-dropdown')) {
    document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
  }
});

// Close mobile menu on ESC
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape' && mobileMenu.classList.contains('open')) {
    hamburgerBtn.classList.remove('active');
    mobileMenu.classList.remove('open');
    document.body.style.overflow = '';
  }
});

// ‚îÄ‚îÄ Progress bar ‚îÄ‚îÄ
window.addEventListener('scroll', function() {
  var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
  var scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  var progress = (scrollTop / scrollHeight) * 100;
  document.getElementById('progressBar').style.width = progress + '%';
});

// ‚îÄ‚îÄ Q&A toggle ‚îÄ‚îÄ
function toggleQA(el) {
  el.closest('.qa-item').classList.toggle('open');
}

// ‚îÄ‚îÄ TOC side dots ‚îÄ‚îÄ
var sections = document.querySelectorAll('.section, .hero');
var tocContainer = document.getElementById('tocSidebar');

sections.forEach(function(sec, i) {
  var dot = document.createElement('div');
  dot.className = 'toc-dot';
  dot.title = sec.id || 'Section ' + i;
  dot.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    scrollToTarget(sec.id);
  });
  tocContainer.appendChild(dot);
});

// ‚îÄ‚îÄ Scroll spy ‚Äî highlights active nav items, dots, and mobile items ‚îÄ‚îÄ
// Build lookup: section ID ‚Üí which parent dropdown + which sub-items
var sectionToNav = {};
document.querySelectorAll('.nav-sub-item[data-target]').forEach(function(item) {
  var tid = item.getAttribute('data-target');
  sectionToNav[tid] = {
    subItem: item,
    dropdown: item.closest('.nav-dropdown')
  };
});

var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) {
      var idx = Array.from(sections).indexOf(entry.target);
      var id = entry.target.id;

      // TOC dots
      document.querySelectorAll('.toc-dot').forEach(function(d, i) {
        d.classList.toggle('active', i === idx);
      });

      // Desktop nav: clear all active states
      document.querySelectorAll('.nav-sub-item.active, .nav-item.active').forEach(function(el) {
        el.classList.remove('active');
      });

      // Highlight matching sub-item + parent dropdown trigger
      if (sectionToNav[id]) {
        sectionToNav[id].subItem.classList.add('active');
        var trigger = sectionToNav[id].dropdown.querySelector(':scope > .nav-item');
        if (trigger) trigger.classList.add('active');
      }
      // Direct nav items (Home)
      var directItem = document.querySelector('.nav-item[data-target="' + id + '"]');
      if (directItem) directItem.classList.add('active');

      // Mobile menu
      document.querySelectorAll('.mobile-menu-item.active').forEach(function(el) { el.classList.remove('active'); });
      var mobileItem = document.querySelector('.mobile-menu-item[data-target="' + id + '"]');
      if (mobileItem) mobileItem.classList.add('active');
    }
  });
}, { rootMargin: '-20% 0px -70% 0px' });

sections.forEach(function(s) { observer.observe(s); });

// ‚îÄ‚îÄ Conformed Dimensions SVG Lines ‚îÄ‚îÄ
function drawConformedLines() {
  var svg = document.getElementById('conformedSvg');
  var container = document.getElementById('conformedDiagram');
  if (!svg || !container) return;

  // Clear existing lines
  var existing = svg.querySelectorAll('.cd-line');
  existing.forEach(function(l) { l.remove(); });

  var containerRect = container.getBoundingClientRect();

  function getCenter(id) {
    var el = document.getElementById(id);
    if (!el) return null;
    var r = el.getBoundingClientRect();
    return {
      x: r.left - containerRect.left + r.width / 2,
      y: r.top - containerRect.top + r.height / 2,
      right: r.right - containerRect.left,
      left: r.left - containerRect.left
    };
  }

  // Connection map: [dim_id, fact_id, color, offset]
  // offset shifts the line vertically to avoid overlaps
  var connections = [
    // dim_date ‚Üí all 3 facts
    ['cd-dim-date', 'cd-fct-sales',     '#f97316', -4],
    ['cd-dim-date', 'cd-fct-inventory', '#14b8a6',  0],
    ['cd-dim-date', 'cd-fct-marketing', '#a78bfa',  4],
    // dim_product ‚Üí all 3 facts
    ['cd-dim-product', 'cd-fct-sales',     '#f97316', -4],
    ['cd-dim-product', 'cd-fct-inventory', '#14b8a6',  0],
    ['cd-dim-product', 'cd-fct-marketing', '#a78bfa',  4],
    // dim_customer ‚Üí sales + marketing (NOT inventory)
    ['cd-dim-customer', 'cd-fct-sales',     '#f97316', -3],
    ['cd-dim-customer', 'cd-fct-marketing', '#a78bfa',  3],
    // dim_store ‚Üí sales + inventory (NOT marketing)
    ['cd-dim-store', 'cd-fct-sales',     '#f97316', -3],
    ['cd-dim-store', 'cd-fct-inventory', '#14b8a6',  3]
  ];

  // Update SVG viewBox to match container
  svg.setAttribute('viewBox', '0 0 ' + containerRect.width + ' ' + containerRect.height);

  connections.forEach(function(conn) {
    var from = getCenter(conn[0]);
    var to = getCenter(conn[1]);
    if (!from || !to) return;

    var line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    line.setAttribute('class', 'cd-line');
    line.setAttribute('x1', from.right + 2);
    line.setAttribute('y1', from.y + conn[3]);
    line.setAttribute('x2', to.left - 2);
    line.setAttribute('y2', to.y + conn[3]);
    line.setAttribute('stroke', conn[2]);
    line.setAttribute('stroke-width', '1.3');
    line.setAttribute('stroke-dasharray', '5 4');
    line.setAttribute('opacity', '0.45');
    svg.appendChild(line);
  });
}

// Draw lines after DOM is ready and on resize
setTimeout(drawConformedLines, 300);
window.addEventListener('resize', drawConformedLines);
</script>
</body>
</html>
